openapi: 3.1.0
info:
  title: QuikApp API
  description: |
    QuikApp is an enterprise communication platform providing real-time messaging,
    voice/video calls, file sharing, and team collaboration features.

    ## Authentication
    Most endpoints require authentication using JWT Bearer tokens.
    Obtain tokens via the `/auth/login` or `/auth/oauth` endpoints.

    ## Rate Limiting
    API requests are rate-limited per user/IP:
    - Standard endpoints: 1000 requests/minute
    - Auth endpoints: 20 requests/minute
    - Upload endpoints: 100 requests/minute

    ## Pagination
    List endpoints support cursor-based pagination using `cursor` and `limit` parameters.
    Some endpoints also support page-based pagination with `page` and `limit`.

    ## WebSocket
    Real-time features are available via WebSocket at `wss://ws.quikapp.io`

    ## Error Handling
    All errors return a consistent JSON structure with `error.code`, `error.message`,
    and optional `error.details` array for validation errors.
  version: 1.0.0
  contact:
    name: QuikApp API Support
    email: api-support@quikapp.io
    url: https://docs.quikapp.io
  license:
    name: Apache 2.0
    url: https://www.apache.org/licenses/LICENSE-2.0
  x-logo:
    url: https://quikapp.io/logo.png
servers:
  - url: https://api.quikapp.io/v1
    description: Production server
  - url: https://api.staging.quikapp.io/v1
    description: Staging server
  - url: http://localhost:3000/v1
    description: Local development
security:
  - BearerAuth: []
tags:
  - name: Authentication
    description: User authentication and authorization
  - name: MFA
    description: Multi-factor authentication
  - name: Users
    description: User management and profiles
  - name: Bookmarks
    description: User bookmarks
  - name: Workspaces
    description: Workspace management
  - name: Members
    description: Workspace and channel membership
  - name: Invites
    description: Workspace invitations
  - name: Channels
    description: Channel management within workspaces
  - name: Direct Messages
    description: Direct and group messages
  - name: Messages
    description: Messaging operations
  - name: Reactions
    description: Message reactions
  - name: Threads
    description: Thread discussions
  - name: Calls
    description: Voice and video calls
  - name: Huddles
    description: Quick audio huddles
  - name: Files
    description: File uploads and management
  - name: Search
    description: Search across messages, files, and users
  - name: Notifications
    description: Notification management
  - name: Presence
    description: User presence and status
paths:
  /auth/login:
    post:
      tags:
        - Authentication
      summary: Login with credentials
      description: Authenticate user with email and password. Returns tokens and user data.
      operationId: login
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginRequest'
      responses:
        '200':
          description: Login successful
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LoginResponse'
        '401':
          description: Invalid credentials
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '403':
          description: Account locked or MFA required
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/Error'
                  - type: object
                    properties:
                      mfaRequired:
                        type: boolean
                      mfaMethods:
                        type: array
                        items:
                          type: string
        '429':
          description: Too many login attempts
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /auth/register:
    post:
      tags:
        - Authentication
      summary: Register new account
      description: Create a new user account. Optionally accepts workspace invite code.
      operationId: register
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RegisterRequest'
      responses:
        '201':
          description: Registration successful
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LoginResponse'
        '400':
          description: Invalid input or password requirements not met
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationError'
        '409':
          description: Email already registered
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /auth/logout:
    post:
      tags:
        - Authentication
      summary: Logout current session
      description: Invalidate current session tokens
      operationId: logout
      security:
        - bearerAuth: []
      responses:
        '204':
          description: Logout successful
        '401':
          description: Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /auth/refresh:
    post:
      tags:
        - Authentication
      summary: Refresh access token
      description: Exchange refresh token for new access token
      operationId: refreshToken
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RefreshTokenRequest'
      responses:
        '200':
          description: Token refreshed successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TokenPair'
        '401':
          description: Invalid or expired refresh token
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /auth/password-reset:
    post:
      tags:
        - Authentication
      summary: Request password reset
      description: Send password reset link to email
      operationId: requestPasswordReset
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PasswordResetRequest'
      responses:
        '200':
          description: Reset email sent if account exists
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: If an account exists, a reset link has been sent
        '429':
          description: Too many reset requests
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /auth/password-reset/confirm:
    post:
      tags:
        - Authentication
      summary: Confirm password reset
      description: Set new password using reset token
      operationId: confirmPasswordReset
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PasswordResetConfirm'
      responses:
        '200':
          description: Password reset successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Password has been reset successfully
        '400':
          description: Invalid or expired token
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /auth/oauth:
    post:
      tags:
        - Authentication
      summary: OAuth login/signup
      description: Authenticate using OAuth provider (Google, GitHub, Microsoft, Apple)
      operationId: oauthLogin
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OAuthRequest'
      responses:
        '200':
          description: OAuth authentication successful
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LoginResponse'
        '400':
          description: Invalid OAuth code or configuration
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /auth/oauth/url:
    get:
      tags:
        - Authentication
      summary: Get OAuth authorization URL
      description: Get the authorization URL for the specified OAuth provider
      operationId: getOAuthUrl
      security: []
      parameters:
        - name: provider
          in: query
          required: true
          schema:
            type: string
            enum:
              - google
              - github
              - microsoft
              - apple
        - name: redirectUri
          in: query
          required: true
          schema:
            type: string
            format: uri
      responses:
        '200':
          description: OAuth URL generated
          content:
            application/json:
              schema:
                type: object
                properties:
                  url:
                    type: string
                    format: uri
                  state:
                    type: string
  /auth/mfa/setup:
    post:
      tags:
        - Authentication
        - MFA
      summary: Setup MFA
      description: Initialize MFA setup and return TOTP secret
      operationId: setupMfa
      security:
        - bearerAuth: []
      responses:
        '200':
          description: MFA setup initiated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MfaSetupResponse'
        '400':
          description: MFA already enabled
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /auth/mfa/verify:
    post:
      tags:
        - Authentication
        - MFA
      summary: Verify MFA code
      description: Verify TOTP code to complete MFA setup or login
      operationId: verifyMfa
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MfaVerifyRequest'
      responses:
        '200':
          description: MFA verification successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  verified:
                    type: boolean
                  tokens:
                    $ref: '#/components/schemas/TokenPair'
        '401':
          description: Invalid MFA code
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /auth/mfa:
    delete:
      tags:
        - Authentication
        - MFA
      summary: Disable MFA
      description: Disable MFA for current user (requires password confirmation)
      operationId: disableMfa
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - password
              properties:
                password:
                  type: string
                  format: password
      responses:
        '200':
          description: MFA disabled
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        '401':
          description: Invalid password
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /auth/sessions:
    get:
      tags:
        - Authentication
      summary: List active sessions
      description: Get all active sessions for current user
      operationId: listSessions
      security:
        - bearerAuth: []
      responses:
        '200':
          description: List of active sessions
          content:
            application/json:
              schema:
                type: object
                properties:
                  sessions:
                    type: array
                    items:
                      $ref: '#/components/schemas/Session'
  /auth/sessions/{sessionId}:
    delete:
      tags:
        - Authentication
      summary: Revoke session
      description: Revoke a specific session by ID
      operationId: revokeSession
      security:
        - bearerAuth: []
      parameters:
        - name: sessionId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: Session revoked
        '404':
          description: Session not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /auth/sessions/all:
    delete:
      tags:
        - Authentication
      summary: Revoke all other sessions
      description: Revoke all sessions except current
      operationId: revokeAllSessions
      security:
        - bearerAuth: []
      responses:
        '200':
          description: All other sessions revoked
          content:
            application/json:
              schema:
                type: object
                properties:
                  revokedCount:
                    type: integer
  /auth/verify-email:
    post:
      tags:
        - Authentication
      summary: Verify email address
      description: Verify email using token from verification email
      operationId: verifyEmail
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - token
              properties:
                token:
                  type: string
      responses:
        '200':
          description: Email verified
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  verified:
                    type: boolean
        '400':
          description: Invalid or expired token
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /auth/resend-verification:
    post:
      tags:
        - Authentication
      summary: Resend verification email
      description: Resend email verification link
      operationId: resendVerification
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Verification email sent
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        '400':
          description: Email already verified
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '429':
          description: Too many requests
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /users/me:
    get:
      tags:
        - Users
      summary: Get current user
      description: Get the authenticated user's profile
      operationId: getCurrentUser
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Current user profile
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
        '401':
          description: Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    patch:
      tags:
        - Users
      summary: Update current user
      description: Update the authenticated user's profile
      operationId: updateCurrentUser
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserUpdateRequest'
      responses:
        '200':
          description: User updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationError'
    delete:
      tags:
        - Users
      summary: Delete account
      description: Permanently delete current user's account
      operationId: deleteCurrentUser
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - password
                - confirmation
              properties:
                password:
                  type: string
                  format: password
                confirmation:
                  type: string
                  enum:
                    - DELETE MY ACCOUNT
      responses:
        '204':
          description: Account deleted
        '401':
          description: Invalid password
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /users/{userId}:
    get:
      tags:
        - Users
      summary: Get user by ID
      description: Get a user's public profile by ID
      operationId: getUserById
      security:
        - bearerAuth: []
      parameters:
        - name: userId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: User profile
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserProfile'
        '404':
          description: User not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /users/username/{username}:
    get:
      tags:
        - Users
      summary: Get user by username
      description: Get a user's public profile by username
      operationId: getUserByUsername
      security:
        - bearerAuth: []
      parameters:
        - name: username
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: User profile
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserProfile'
        '404':
          description: User not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /users/me/preferences:
    get:
      tags:
        - Users
      summary: Get user preferences
      description: Get current user's preferences
      operationId: getUserPreferences
      security:
        - bearerAuth: []
      responses:
        '200':
          description: User preferences
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserPreferences'
    patch:
      tags:
        - Users
      summary: Update user preferences
      description: Update current user's preferences
      operationId: updateUserPreferences
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserPreferences'
      responses:
        '200':
          description: Preferences updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserPreferences'
  /users/me/status:
    get:
      tags:
        - Users
      summary: Get user status
      description: Get current user's status
      operationId: getUserStatus
      security:
        - bearerAuth: []
      responses:
        '200':
          description: User status
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserStatus'
    put:
      tags:
        - Users
      summary: Set user status
      description: Set current user's status
      operationId: setUserStatus
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserStatus'
      responses:
        '200':
          description: Status updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserStatus'
    delete:
      tags:
        - Users
      summary: Clear user status
      description: Clear current user's custom status
      operationId: clearUserStatus
      security:
        - bearerAuth: []
      responses:
        '204':
          description: Status cleared
  /users/me/avatar:
    put:
      tags:
        - Users
      summary: Upload avatar
      description: Upload a new avatar image
      operationId: uploadAvatar
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - avatar
              properties:
                avatar:
                  type: string
                  format: binary
                  description: Avatar image (JPEG, PNG, GIF, max 5MB)
      responses:
        '200':
          description: Avatar uploaded
          content:
            application/json:
              schema:
                type: object
                properties:
                  avatarUrl:
                    type: string
                    format: uri
        '400':
          description: Invalid image format or size
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    delete:
      tags:
        - Users
      summary: Remove avatar
      description: Remove current user's avatar
      operationId: removeAvatar
      security:
        - bearerAuth: []
      responses:
        '204':
          description: Avatar removed
  /users/me/password:
    post:
      tags:
        - Users
      summary: Change password
      description: Change current user's password
      operationId: changePassword
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - currentPassword
                - newPassword
              properties:
                currentPassword:
                  type: string
                  format: password
                newPassword:
                  type: string
                  format: password
                  minLength: 8
      responses:
        '200':
          description: Password changed
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        '400':
          description: Password requirements not met
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationError'
        '401':
          description: Current password incorrect
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /users/me/email:
    post:
      tags:
        - Users
      summary: Change email
      description: Request email address change
      operationId: changeEmail
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - newEmail
                - password
              properties:
                newEmail:
                  type: string
                  format: email
                password:
                  type: string
                  format: password
      responses:
        '200':
          description: Verification email sent to new address
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        '400':
          description: Invalid email
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationError'
        '401':
          description: Invalid password
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '409':
          description: Email already in use
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /users/me/bookmarks:
    get:
      tags:
        - Users
        - Bookmarks
      summary: List bookmarks
      description: Get current user's bookmarked items
      operationId: listBookmarks
      security:
        - bearerAuth: []
      parameters:
        - name: type
          in: query
          schema:
            type: string
            enum:
              - message
              - file
              - channel
        - name: workspaceId
          in: query
          schema:
            type: string
            format: uuid
        - $ref: '#/components/parameters/PageParam'
        - $ref: '#/components/parameters/LimitParam'
      responses:
        '200':
          description: List of bookmarks
          content:
            application/json:
              schema:
                type: object
                properties:
                  bookmarks:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          format: uuid
                        type:
                          type: string
                          enum:
                            - message
                            - file
                            - channel
                        itemId:
                          type: string
                          format: uuid
                        note:
                          type: string
                        createdAt:
                          type: string
                          format: date-time
                  pagination:
                    $ref: '#/components/schemas/Pagination'
  /users/me/bookmarks/{bookmarkId}:
    delete:
      tags:
        - Users
        - Bookmarks
      summary: Remove bookmark
      description: Remove a bookmark
      operationId: removeBookmark
      security:
        - bearerAuth: []
      parameters:
        - name: bookmarkId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: Bookmark removed
        '404':
          description: Bookmark not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /workspaces:
    get:
      tags:
        - Workspaces
      summary: List user's workspaces
      description: Get all workspaces the current user is a member of
      operationId: listWorkspaces
      security:
        - bearerAuth: []
      responses:
        '200':
          description: List of workspaces
          content:
            application/json:
              schema:
                type: object
                properties:
                  workspaces:
                    type: array
                    items:
                      $ref: '#/components/schemas/Workspace'
    post:
      tags:
        - Workspaces
      summary: Create workspace
      description: Create a new workspace
      operationId: createWorkspace
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/WorkspaceCreateRequest'
      responses:
        '201':
          description: Workspace created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Workspace'
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationError'
        '409':
          description: Slug already taken
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /workspaces/{workspaceId}:
    get:
      tags:
        - Workspaces
      summary: Get workspace
      description: Get workspace details by ID
      operationId: getWorkspace
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Workspace details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Workspace'
        '403':
          description: Not a member of workspace
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Workspace not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    patch:
      tags:
        - Workspaces
      summary: Update workspace
      description: Update workspace details (admin only)
      operationId: updateWorkspace
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/WorkspaceUpdateRequest'
      responses:
        '200':
          description: Workspace updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Workspace'
        '403':
          description: Not authorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    delete:
      tags:
        - Workspaces
      summary: Delete workspace
      description: Delete workspace (owner only)
      operationId: deleteWorkspace
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - confirmation
              properties:
                confirmation:
                  type: string
                  description: Workspace name for confirmation
      responses:
        '204':
          description: Workspace deleted
        '403':
          description: Not the workspace owner
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /workspaces/slug/{slug}:
    get:
      tags:
        - Workspaces
      summary: Get workspace by slug
      description: Get workspace details by URL slug
      operationId: getWorkspaceBySlug
      security:
        - bearerAuth: []
      parameters:
        - name: slug
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Workspace details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Workspace'
        '404':
          description: Workspace not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /workspaces/{workspaceId}/members:
    get:
      tags:
        - Workspaces
        - Members
      summary: List workspace members
      description: Get all members of a workspace
      operationId: listWorkspaceMembers
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: role
          in: query
          schema:
            type: string
            enum:
              - member
              - admin
              - owner
              - guest
        - name: search
          in: query
          schema:
            type: string
          description: Search by name or email
        - $ref: '#/components/parameters/PageParam'
        - $ref: '#/components/parameters/LimitParam'
      responses:
        '200':
          description: List of members
          content:
            application/json:
              schema:
                type: object
                properties:
                  members:
                    type: array
                    items:
                      $ref: '#/components/schemas/WorkspaceMember'
                  pagination:
                    $ref: '#/components/schemas/Pagination'
  /workspaces/{workspaceId}/members/{userId}:
    get:
      tags:
        - Workspaces
        - Members
      summary: Get workspace member
      description: Get details of a specific workspace member
      operationId: getWorkspaceMember
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: userId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Member details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WorkspaceMember'
        '404':
          description: Member not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    patch:
      tags:
        - Workspaces
        - Members
      summary: Update member role
      description: Update a member's role in the workspace (admin only)
      operationId: updateWorkspaceMember
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: userId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                role:
                  type: string
                  enum:
                    - member
                    - admin
                    - guest
                title:
                  type: string
      responses:
        '200':
          description: Member updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WorkspaceMember'
        '403':
          description: Not authorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    delete:
      tags:
        - Workspaces
        - Members
      summary: Remove member
      description: Remove a member from the workspace (admin only)
      operationId: removeWorkspaceMember
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: userId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: Member removed
        '403':
          description: Not authorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /workspaces/{workspaceId}/leave:
    post:
      tags:
        - Workspaces
      summary: Leave workspace
      description: Leave the workspace (cannot be owner)
      operationId: leaveWorkspace
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: Left workspace
        '400':
          description: Cannot leave (owner must transfer ownership first)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /workspaces/{workspaceId}/invites:
    get:
      tags:
        - Workspaces
        - Invites
      summary: List pending invites
      description: Get all pending invites for a workspace (admin only)
      operationId: listWorkspaceInvites
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: status
          in: query
          schema:
            type: string
            enum:
              - pending
              - accepted
              - expired
              - revoked
        - $ref: '#/components/parameters/PageParam'
        - $ref: '#/components/parameters/LimitParam'
      responses:
        '200':
          description: List of invites
          content:
            application/json:
              schema:
                type: object
                properties:
                  invites:
                    type: array
                    items:
                      $ref: '#/components/schemas/WorkspaceInvite'
                  pagination:
                    $ref: '#/components/schemas/Pagination'
    post:
      tags:
        - Workspaces
        - Invites
      summary: Invite members
      description: Send workspace invitations by email (admin only)
      operationId: inviteMembers
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/InviteMembersRequest'
      responses:
        '200':
          description: Invites sent
          content:
            application/json:
              schema:
                type: object
                properties:
                  sent:
                    type: integer
                  failed:
                    type: array
                    items:
                      type: object
                      properties:
                        email:
                          type: string
                        reason:
                          type: string
  /workspaces/{workspaceId}/invites/{inviteId}:
    delete:
      tags:
        - Workspaces
        - Invites
      summary: Revoke invite
      description: Revoke a pending invite
      operationId: revokeInvite
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: inviteId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: Invite revoked
        '404':
          description: Invite not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /workspaces/invites/{inviteCode}/accept:
    post:
      tags:
        - Workspaces
        - Invites
      summary: Accept invite
      description: Accept a workspace invitation
      operationId: acceptInvite
      security:
        - bearerAuth: []
      parameters:
        - name: inviteCode
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Invite accepted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Workspace'
        '400':
          description: Invalid or expired invite
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '409':
          description: Already a member
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /workspaces/{workspaceId}/stats:
    get:
      tags:
        - Workspaces
      summary: Get workspace stats
      description: Get workspace statistics
      operationId: getWorkspaceStats
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Workspace statistics
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WorkspaceStats'
  /workspaces/{workspaceId}/icon:
    put:
      tags:
        - Workspaces
      summary: Upload workspace icon
      description: Upload a new workspace icon (admin only)
      operationId: uploadWorkspaceIcon
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - icon
              properties:
                icon:
                  type: string
                  format: binary
      responses:
        '200':
          description: Icon uploaded
          content:
            application/json:
              schema:
                type: object
                properties:
                  iconUrl:
                    type: string
                    format: uri
    delete:
      tags:
        - Workspaces
      summary: Remove workspace icon
      description: Remove workspace icon (admin only)
      operationId: removeWorkspaceIcon
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: Icon removed
  /workspaces/{workspaceId}/channels:
    get:
      tags:
        - Channels
      summary: List channels
      description: Get all channels in a workspace that the user can access
      operationId: listChannels
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: type
          in: query
          schema:
            type: string
            enum:
              - public
              - private
              - dm
              - group_dm
        - name: joined
          in: query
          schema:
            type: boolean
          description: Filter to joined channels only
        - name: search
          in: query
          schema:
            type: string
          description: Search by channel name
        - $ref: '#/components/parameters/PageParam'
        - $ref: '#/components/parameters/LimitParam'
      responses:
        '200':
          description: List of channels
          content:
            application/json:
              schema:
                type: object
                properties:
                  channels:
                    type: array
                    items:
                      $ref: '#/components/schemas/Channel'
                  pagination:
                    $ref: '#/components/schemas/Pagination'
    post:
      tags:
        - Channels
      summary: Create channel
      description: Create a new channel in the workspace
      operationId: createChannel
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ChannelCreateRequest'
      responses:
        '201':
          description: Channel created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Channel'
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationError'
        '409':
          description: Channel name already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /workspaces/{workspaceId}/channels/{channelId}:
    get:
      tags:
        - Channels
      summary: Get channel
      description: Get channel details by ID
      operationId: getChannel
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Channel details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Channel'
        '403':
          description: Not a member of private channel
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Channel not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    patch:
      tags:
        - Channels
      summary: Update channel
      description: Update channel details (admin only for settings)
      operationId: updateChannel
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ChannelUpdateRequest'
      responses:
        '200':
          description: Channel updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Channel'
        '403':
          description: Not authorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    delete:
      tags:
        - Channels
      summary: Delete channel
      description: Delete a channel (admin only, cannot delete default channel)
      operationId: deleteChannel
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: Channel deleted
        '400':
          description: Cannot delete default channel
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '403':
          description: Not authorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /workspaces/{workspaceId}/channels/{channelId}/members:
    get:
      tags:
        - Channels
        - Members
      summary: List channel members
      description: Get all members of a channel
      operationId: listChannelMembers
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - $ref: '#/components/parameters/PageParam'
        - $ref: '#/components/parameters/LimitParam'
      responses:
        '200':
          description: List of channel members
          content:
            application/json:
              schema:
                type: object
                properties:
                  members:
                    type: array
                    items:
                      $ref: '#/components/schemas/ChannelMember'
                  pagination:
                    $ref: '#/components/schemas/Pagination'
    post:
      tags:
        - Channels
        - Members
      summary: Add members
      description: Add members to a channel
      operationId: addChannelMembers
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AddMembersRequest'
      responses:
        '200':
          description: Members added
          content:
            application/json:
              schema:
                type: object
                properties:
                  added:
                    type: integer
                  alreadyMembers:
                    type: integer
  /workspaces/{workspaceId}/channels/{channelId}/members/{userId}:
    get:
      tags:
        - Channels
        - Members
      summary: Get channel member
      description: Get details of a channel member
      operationId: getChannelMember
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: userId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Channel member details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ChannelMember'
        '404':
          description: Member not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    patch:
      tags:
        - Channels
        - Members
      summary: Update channel member
      description: Update member role in channel (channel admin only)
      operationId: updateChannelMember
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: userId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                role:
                  type: string
                  enum:
                    - member
                    - admin
      responses:
        '200':
          description: Member updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ChannelMember'
    delete:
      tags:
        - Channels
        - Members
      summary: Remove channel member
      description: Remove a member from the channel
      operationId: removeChannelMember
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: userId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: Member removed
  /workspaces/{workspaceId}/channels/{channelId}/join:
    post:
      tags:
        - Channels
      summary: Join channel
      description: Join a public channel
      operationId: joinChannel
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Joined channel
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Channel'
        '403':
          description: Cannot join private channel
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /workspaces/{workspaceId}/channels/{channelId}/leave:
    post:
      tags:
        - Channels
      summary: Leave channel
      description: Leave a channel (cannot leave default channel)
      operationId: leaveChannel
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: Left channel
        '400':
          description: Cannot leave default channel
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /workspaces/{workspaceId}/channels/{channelId}/archive:
    post:
      tags:
        - Channels
      summary: Archive channel
      description: Archive a channel (admin only)
      operationId: archiveChannel
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Channel archived
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Channel'
  /workspaces/{workspaceId}/channels/{channelId}/unarchive:
    post:
      tags:
        - Channels
      summary: Unarchive channel
      description: Unarchive a channel (admin only)
      operationId: unarchiveChannel
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Channel unarchived
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Channel'
  /workspaces/{workspaceId}/channels/{channelId}/notifications:
    get:
      tags:
        - Channels
      summary: Get channel notification settings
      description: Get notification settings for channel
      operationId: getChannelNotifications
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Channel notification settings
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ChannelNotificationSettings'
    put:
      tags:
        - Channels
      summary: Update channel notification settings
      description: Update notification settings for channel
      operationId: updateChannelNotifications
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ChannelNotificationSettings'
      responses:
        '200':
          description: Settings updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ChannelNotificationSettings'
  /workspaces/{workspaceId}/dms:
    get:
      tags:
        - Channels
        - Direct Messages
      summary: List direct message channels
      description: Get all DM and group DM channels
      operationId: listDirectMessages
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - $ref: '#/components/parameters/PageParam'
        - $ref: '#/components/parameters/LimitParam'
      responses:
        '200':
          description: List of DM channels
          content:
            application/json:
              schema:
                type: object
                properties:
                  channels:
                    type: array
                    items:
                      oneOf:
                        - $ref: '#/components/schemas/DirectMessage'
                        - $ref: '#/components/schemas/GroupDirectMessage'
                  pagination:
                    $ref: '#/components/schemas/Pagination'
  /workspaces/{workspaceId}/dms/open:
    post:
      tags:
        - Channels
        - Direct Messages
      summary: Open DM channel
      description: Open or create a direct message channel with a user
      operationId: openDirectMessage
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - userId
              properties:
                userId:
                  type: string
                  format: uuid
      responses:
        '200':
          description: DM channel opened
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DirectMessage'
  /workspaces/{workspaceId}/dms/group:
    post:
      tags:
        - Channels
        - Direct Messages
      summary: Create group DM
      description: Create a new group direct message channel
      operationId: createGroupDM
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - userIds
              properties:
                userIds:
                  type: array
                  items:
                    type: string
                    format: uuid
                  minItems: 2
                  maxItems: 8
                name:
                  type: string
                  maxLength: 100
      responses:
        '201':
          description: Group DM created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GroupDirectMessage'
  /workspaces/{workspaceId}/channels/{channelId}/messages:
    get:
      tags:
        - Messages
      summary: List messages
      description: Get messages from a channel with pagination
      operationId: listMessages
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: before
          in: query
          schema:
            type: string
            format: date-time
          description: Get messages before this timestamp
        - name: after
          in: query
          schema:
            type: string
            format: date-time
          description: Get messages after this timestamp
        - name: around
          in: query
          schema:
            type: string
            format: uuid
          description: Get messages around this message ID
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 50
      responses:
        '200':
          description: List of messages
          content:
            application/json:
              schema:
                type: object
                properties:
                  messages:
                    type: array
                    items:
                      $ref: '#/components/schemas/Message'
                  hasMore:
                    type: boolean
    post:
      tags:
        - Messages
      summary: Send message
      description: Send a new message to a channel
      operationId: sendMessage
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MessageCreateRequest'
      responses:
        '201':
          description: Message sent
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Message'
        '400':
          description: Invalid message content
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationError'
        '403':
          description: Cannot post to this channel
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /workspaces/{workspaceId}/channels/{channelId}/messages/{messageId}:
    get:
      tags:
        - Messages
      summary: Get message
      description: Get a specific message by ID
      operationId: getMessage
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: messageId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Message details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Message'
        '404':
          description: Message not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    patch:
      tags:
        - Messages
      summary: Edit message
      description: Edit a message (author only, within edit window)
      operationId: editMessage
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: messageId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MessageUpdateRequest'
      responses:
        '200':
          description: Message updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Message'
        '403':
          description: Not authorized to edit
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    delete:
      tags:
        - Messages
      summary: Delete message
      description: Delete a message (author or admin)
      operationId: deleteMessage
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: messageId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: Message deleted
        '403':
          description: Not authorized to delete
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /workspaces/{workspaceId}/channels/{channelId}/messages/{messageId}/reactions:
    get:
      tags:
        - Messages
        - Reactions
      summary: Get message reactions
      description: Get all reactions on a message
      operationId: getMessageReactions
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: messageId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Message reactions
          content:
            application/json:
              schema:
                type: object
                properties:
                  reactions:
                    type: array
                    items:
                      $ref: '#/components/schemas/Reaction'
    post:
      tags:
        - Messages
        - Reactions
      summary: Add reaction
      description: Add a reaction to a message
      operationId: addReaction
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: messageId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ReactionRequest'
      responses:
        '201':
          description: Reaction added
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Reaction'
        '409':
          description: Already reacted with this emoji
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /workspaces/{workspaceId}/channels/{channelId}/messages/{messageId}/reactions/{emoji}:
    delete:
      tags:
        - Messages
        - Reactions
      summary: Remove reaction
      description: Remove a reaction from a message
      operationId: removeReaction
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: messageId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: emoji
          in: path
          required: true
          schema:
            type: string
      responses:
        '204':
          description: Reaction removed
        '404':
          description: Reaction not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /workspaces/{workspaceId}/channels/{channelId}/messages/{messageId}/pin:
    post:
      tags:
        - Messages
      summary: Pin message
      description: Pin a message to the channel
      operationId: pinMessage
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: messageId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Message pinned
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Message'
        '400':
          description: Message already pinned or pin limit reached
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /workspaces/{workspaceId}/channels/{channelId}/messages/{messageId}/unpin:
    delete:
      tags:
        - Messages
      summary: Unpin message
      description: Unpin a message from the channel
      operationId: unpinMessage
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: messageId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: Message unpinned
  /workspaces/{workspaceId}/channels/{channelId}/pins:
    get:
      tags:
        - Messages
      summary: List pinned messages
      description: Get all pinned messages in a channel
      operationId: listPinnedMessages
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Pinned messages
          content:
            application/json:
              schema:
                type: object
                properties:
                  messages:
                    type: array
                    items:
                      $ref: '#/components/schemas/Message'
  /workspaces/{workspaceId}/channels/{channelId}/read:
    post:
      tags:
        - Messages
      summary: Mark channel as read
      description: Mark all messages in channel as read
      operationId: markChannelRead
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                messageId:
                  type: string
                  format: uuid
                  description: Mark as read up to this message
      responses:
        '200':
          description: Channel marked as read
          content:
            application/json:
              schema:
                type: object
                properties:
                  lastReadAt:
                    type: string
                    format: date-time
                  lastReadMessageId:
                    type: string
                    format: uuid
  /workspaces/{workspaceId}/scheduled-messages:
    get:
      tags:
        - Messages
      summary: List scheduled messages
      description: Get user's scheduled messages
      operationId: listScheduledMessages
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: channelId
          in: query
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Scheduled messages
          content:
            application/json:
              schema:
                type: object
                properties:
                  messages:
                    type: array
                    items:
                      $ref: '#/components/schemas/ScheduledMessage'
    post:
      tags:
        - Messages
      summary: Schedule message
      description: Schedule a message for later delivery
      operationId: scheduleMessage
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ScheduleMessageRequest'
      responses:
        '201':
          description: Message scheduled
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ScheduledMessage'
  /workspaces/{workspaceId}/scheduled-messages/{messageId}:
    get:
      tags:
        - Messages
      summary: Get scheduled message
      description: Get a scheduled message by ID
      operationId: getScheduledMessage
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: messageId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Scheduled message details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ScheduledMessage'
    patch:
      tags:
        - Messages
      summary: Update scheduled message
      description: Update a scheduled message
      operationId: updateScheduledMessage
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: messageId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ScheduleMessageRequest'
      responses:
        '200':
          description: Scheduled message updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ScheduledMessage'
    delete:
      tags:
        - Messages
      summary: Delete scheduled message
      description: Delete a scheduled message
      operationId: deleteScheduledMessage
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: messageId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: Scheduled message deleted
  /workspaces/{workspaceId}/threads:
    get:
      tags:
        - Threads
      summary: List threads
      description: Get threads the user is subscribed to or all threads in workspace
      operationId: listThreads
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: channelId
          in: query
          schema:
            type: string
            format: uuid
          description: Filter by channel
        - name: subscribed
          in: query
          schema:
            type: boolean
          description: Only show subscribed threads
        - name: unread
          in: query
          schema:
            type: boolean
          description: Only show threads with unread replies
        - name: sort
          in: query
          schema:
            type: string
            enum:
              - recent_activity
              - created_at
            default: recent_activity
        - $ref: '#/components/parameters/PageParam'
        - $ref: '#/components/parameters/LimitParam'
      responses:
        '200':
          description: List of threads
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ThreadListResponse'
  /workspaces/{workspaceId}/channels/{channelId}/threads/{threadId}:
    get:
      tags:
        - Threads
      summary: Get thread
      description: Get a thread with its parent message
      operationId: getThread
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: threadId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Thread details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Thread'
        '404':
          description: Thread not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    patch:
      tags:
        - Threads
      summary: Update thread
      description: Update thread properties (e.g., mark as resolved)
      operationId: updateThread
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: threadId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateThreadRequest'
      responses:
        '200':
          description: Thread updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Thread'
  /workspaces/{workspaceId}/channels/{channelId}/threads/{threadId}/replies:
    get:
      tags:
        - Threads
      summary: List thread replies
      description: Get all replies in a thread
      operationId: listThreadReplies
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: threadId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: before
          in: query
          schema:
            type: string
            format: date-time
        - name: after
          in: query
          schema:
            type: string
            format: date-time
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 50
      responses:
        '200':
          description: Thread replies
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ThreadRepliesResponse'
    post:
      tags:
        - Threads
      summary: Reply to thread
      description: Post a reply to a thread
      operationId: replyToThread
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: threadId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MessageCreateRequest'
      responses:
        '201':
          description: Reply posted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ThreadReply'
  /workspaces/{workspaceId}/channels/{channelId}/threads/{threadId}/subscribe:
    post:
      tags:
        - Threads
      summary: Subscribe to thread
      description: Subscribe to receive notifications for thread replies
      operationId: subscribeToThread
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: threadId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SubscribeThreadRequest'
      responses:
        '200':
          description: Subscribed to thread
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ThreadSubscription'
  /workspaces/{workspaceId}/channels/{channelId}/threads/{threadId}/unsubscribe:
    delete:
      tags:
        - Threads
      summary: Unsubscribe from thread
      description: Unsubscribe from thread notifications
      operationId: unsubscribeFromThread
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: threadId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: Unsubscribed from thread
  /workspaces/{workspaceId}/channels/{channelId}/threads/{threadId}/read:
    post:
      tags:
        - Threads
      summary: Mark thread as read
      description: Mark all replies in thread as read
      operationId: markThreadRead
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: threadId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Thread marked as read
          content:
            application/json:
              schema:
                type: object
                properties:
                  lastReadAt:
                    type: string
                    format: date-time
                  lastReadMessageId:
                    type: string
                    format: uuid
  /workspaces/{workspaceId}/channels/{channelId}/threads/{threadId}/participants:
    get:
      tags:
        - Threads
      summary: List thread participants
      description: Get all users who have participated in a thread
      operationId: listThreadParticipants
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: threadId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Thread participants
          content:
            application/json:
              schema:
                type: object
                properties:
                  participants:
                    type: array
                    items:
                      $ref: '#/components/schemas/UserProfile'
                  count:
                    type: integer
  /workspaces/{workspaceId}/threads/read-all:
    post:
      tags:
        - Threads
      summary: Mark all threads as read
      description: Mark all threads in workspace as read
      operationId: markAllThreadsRead
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: All threads marked as read
          content:
            application/json:
              schema:
                type: object
                properties:
                  markedCount:
                    type: integer
  /workspaces/{workspaceId}/files:
    get:
      tags:
        - Files
      summary: List files
      description: Get files shared in workspace
      operationId: listFiles
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: channelId
          in: query
          schema:
            type: string
            format: uuid
          description: Filter by channel
        - name: userId
          in: query
          schema:
            type: string
            format: uuid
          description: Filter by uploader
        - name: category
          in: query
          schema:
            type: string
            enum:
              - image
              - video
              - audio
              - document
              - spreadsheet
              - presentation
              - archive
              - code
              - other
        - name: search
          in: query
          schema:
            type: string
          description: Search by filename
        - name: dateFrom
          in: query
          schema:
            type: string
            format: date
        - name: dateTo
          in: query
          schema:
            type: string
            format: date
        - $ref: '#/components/parameters/PageParam'
        - $ref: '#/components/parameters/LimitParam'
      responses:
        '200':
          description: List of files
          content:
            application/json:
              schema:
                type: object
                properties:
                  files:
                    type: array
                    items:
                      $ref: '#/components/schemas/File'
                  pagination:
                    $ref: '#/components/schemas/Pagination'
  /workspaces/{workspaceId}/files/upload:
    post:
      tags:
        - Files
      summary: Initialize file upload
      description: Get a pre-signed URL for file upload
      operationId: initFileUpload
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/FileUploadRequest'
      responses:
        '200':
          description: Upload URL generated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FileUploadResponse'
        '400':
          description: Invalid file type or size exceeds limit
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '413':
          description: File too large
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /workspaces/{workspaceId}/files/{fileId}:
    get:
      tags:
        - Files
      summary: Get file
      description: Get file details by ID
      operationId: getFile
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: fileId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: File details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/File'
        '404':
          description: File not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    patch:
      tags:
        - Files
      summary: Update file
      description: Update file metadata
      operationId: updateFile
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: fileId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/FileUpdateRequest'
      responses:
        '200':
          description: File updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/File'
    delete:
      tags:
        - Files
      summary: Delete file
      description: Delete a file (uploader or admin)
      operationId: deleteFile
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: fileId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: File deleted
        '403':
          description: Not authorized to delete
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /workspaces/{workspaceId}/files/{fileId}/complete:
    post:
      tags:
        - Files
      summary: Complete file upload
      description: Mark file upload as complete after uploading to pre-signed URL
      operationId: completeFileUpload
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: fileId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: File upload completed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/File'
        '400':
          description: Upload not found or already completed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /workspaces/{workspaceId}/files/{fileId}/download:
    get:
      tags:
        - Files
      summary: Get download URL
      description: Get a temporary download URL for a file
      operationId: getFileDownloadUrl
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: fileId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: disposition
          in: query
          schema:
            type: string
            enum:
              - inline
              - attachment
            default: attachment
      responses:
        '200':
          description: Download URL
          content:
            application/json:
              schema:
                type: object
                properties:
                  url:
                    type: string
                    format: uri
                  expiresAt:
                    type: string
                    format: date-time
  /workspaces/{workspaceId}/files/{fileId}/share:
    post:
      tags:
        - Files
      summary: Share file
      description: Share a file with users, channels, or make public
      operationId: shareFile
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: fileId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ShareFileRequest'
      responses:
        '200':
          description: File shared
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FileShare'
  /workspaces/{workspaceId}/files/{fileId}/shares:
    get:
      tags:
        - Files
      summary: List file shares
      description: Get all shares for a file
      operationId: listFileShares
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: fileId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: File shares
          content:
            application/json:
              schema:
                type: object
                properties:
                  shares:
                    type: array
                    items:
                      $ref: '#/components/schemas/FileShare'
  /workspaces/{workspaceId}/files/{fileId}/shares/{shareId}:
    delete:
      tags:
        - Files
      summary: Revoke file share
      description: Revoke a file share
      operationId: revokeFileShare
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: fileId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: shareId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: Share revoked
  /workspaces/{workspaceId}/storage:
    get:
      tags:
        - Files
      summary: Get storage quota
      description: Get workspace storage usage and limits
      operationId: getStorageQuota
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Storage quota information
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StorageQuota'
  /workspaces/{workspaceId}/links:
    get:
      tags:
        - Files
      summary: List shared links
      description: Get external links shared in workspace
      operationId: listExternalLinks
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: channelId
          in: query
          schema:
            type: string
            format: uuid
        - $ref: '#/components/parameters/PageParam'
        - $ref: '#/components/parameters/LimitParam'
      responses:
        '200':
          description: List of external links
          content:
            application/json:
              schema:
                type: object
                properties:
                  links:
                    type: array
                    items:
                      allOf:
                        - $ref: '#/components/schemas/ExternalLink'
                        - type: object
                          properties:
                            messageId:
                              type: string
                              format: uuid
                            sharedBy:
                              $ref: '#/components/schemas/UserProfile'
                            sharedAt:
                              type: string
                              format: date-time
                  pagination:
                    $ref: '#/components/schemas/Pagination'
  /workspaces/{workspaceId}/calls:
    get:
      tags:
        - Calls
      summary: List calls
      description: Get call history for workspace
      operationId: listCalls
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: channelId
          in: query
          schema:
            type: string
            format: uuid
        - name: status
          in: query
          schema:
            type: string
            enum:
              - active
              - ended
              - missed
        - name: type
          in: query
          schema:
            type: string
            enum:
              - audio
              - video
        - $ref: '#/components/parameters/PageParam'
        - $ref: '#/components/parameters/LimitParam'
      responses:
        '200':
          description: List of calls
          content:
            application/json:
              schema:
                type: object
                properties:
                  calls:
                    type: array
                    items:
                      $ref: '#/components/schemas/Call'
                  pagination:
                    $ref: '#/components/schemas/Pagination'
    post:
      tags:
        - Calls
      summary: Start call
      description: Start a new call
      operationId: startCall
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CallCreateRequest'
      responses:
        '201':
          description: Call started
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Call'
        '400':
          description: Invalid call configuration
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /workspaces/{workspaceId}/calls/active:
    get:
      tags:
        - Calls
      summary: List active calls
      description: Get all currently active calls in workspace
      operationId: listActiveCalls
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Active calls
          content:
            application/json:
              schema:
                type: object
                properties:
                  calls:
                    type: array
                    items:
                      $ref: '#/components/schemas/Call'
  /workspaces/{workspaceId}/calls/scheduled:
    get:
      tags:
        - Calls
      summary: List scheduled calls
      description: Get upcoming scheduled calls
      operationId: listScheduledCalls
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: from
          in: query
          schema:
            type: string
            format: date-time
        - name: to
          in: query
          schema:
            type: string
            format: date-time
      responses:
        '200':
          description: Scheduled calls
          content:
            application/json:
              schema:
                type: object
                properties:
                  calls:
                    type: array
                    items:
                      $ref: '#/components/schemas/ScheduledCall'
    post:
      tags:
        - Calls
      summary: Schedule call
      description: Schedule a call for later
      operationId: scheduleCall
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CallCreateRequest'
      responses:
        '201':
          description: Call scheduled
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ScheduledCall'
  /workspaces/{workspaceId}/calls/{callId}:
    get:
      tags:
        - Calls
      summary: Get call
      description: Get call details by ID
      operationId: getCall
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: callId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Call details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Call'
        '404':
          description: Call not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    patch:
      tags:
        - Calls
      summary: Update call
      description: Update call settings (host only)
      operationId: updateCall
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: callId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CallUpdateRequest'
      responses:
        '200':
          description: Call updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Call'
  /workspaces/{workspaceId}/calls/{callId}/join:
    post:
      tags:
        - Calls
      summary: Join call
      description: Join an active call
      operationId: joinCall
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: callId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/JoinCallRequest'
      responses:
        '200':
          description: Joined call
          content:
            application/json:
              schema:
                type: object
                properties:
                  call:
                    $ref: '#/components/schemas/Call'
                  connectionInfo:
                    type: object
                    properties:
                      token:
                        type: string
                      serverUrl:
                        type: string
                        format: uri
                      iceServers:
                        type: array
                        items:
                          type: object
                          properties:
                            urls:
                              type: array
                              items:
                                type: string
                            username:
                              type: string
                            credential:
                              type: string
        '401':
          description: Invalid password
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '403':
          description: In waiting room
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: object
                    properties:
                      code:
                        type: string
                      message:
                        type: string
                  waitingRoom:
                    type: boolean
  /workspaces/{workspaceId}/calls/{callId}/leave:
    post:
      tags:
        - Calls
      summary: Leave call
      description: Leave the current call
      operationId: leaveCall
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: callId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: Left call
  /workspaces/{workspaceId}/calls/{callId}/end:
    post:
      tags:
        - Calls
      summary: End call
      description: End call for all participants (host only)
      operationId: endCall
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: callId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Call ended
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Call'
        '403':
          description: Not the host
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /workspaces/{workspaceId}/calls/{callId}/action:
    post:
      tags:
        - Calls
      summary: Call action
      description: Perform an action in the call (mute, screen share, etc.)
      operationId: callAction
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: callId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CallActionRequest'
      responses:
        '200':
          description: Action performed
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  participant:
                    $ref: '#/components/schemas/CallParticipant'
  /workspaces/{workspaceId}/calls/{callId}/invite:
    post:
      tags:
        - Calls
      summary: Invite to call
      description: Invite users to join the call
      operationId: inviteToCall
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: callId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - userIds
              properties:
                userIds:
                  type: array
                  items:
                    type: string
                    format: uuid
                  maxItems: 50
      responses:
        '200':
          description: Invites sent
          content:
            application/json:
              schema:
                type: object
                properties:
                  invited:
                    type: integer
  /workspaces/{workspaceId}/calls/{callId}/participants:
    get:
      tags:
        - Calls
      summary: List call participants
      description: Get all participants in a call
      operationId: listCallParticipants
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: callId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Call participants
          content:
            application/json:
              schema:
                type: object
                properties:
                  participants:
                    type: array
                    items:
                      $ref: '#/components/schemas/CallParticipant'
  /workspaces/{workspaceId}/calls/{callId}/recording:
    get:
      tags:
        - Calls
      summary: Get call recording
      description: Get recording details for a call
      operationId: getCallRecording
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: callId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Recording details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CallRecording'
        '404':
          description: No recording found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /workspaces/{workspaceId}/huddles:
    get:
      tags:
        - Huddles
      summary: List active huddles
      description: Get all active huddles in workspace
      operationId: listHuddles
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Active huddles
          content:
            application/json:
              schema:
                type: object
                properties:
                  huddles:
                    type: array
                    items:
                      $ref: '#/components/schemas/Huddle'
  /workspaces/{workspaceId}/channels/{channelId}/huddle:
    get:
      tags:
        - Huddles
      summary: Get channel huddle
      description: Get active huddle in a channel (if any)
      operationId: getChannelHuddle
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Channel huddle (or null if none active)
          content:
            application/json:
              schema:
                type: object
                properties:
                  huddle:
                    oneOf:
                      - $ref: '#/components/schemas/Huddle'
                      - type: 'null'
    post:
      tags:
        - Huddles
      summary: Start huddle
      description: Start a new huddle in a channel
      operationId: startHuddle
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/StartHuddleRequest'
      responses:
        '201':
          description: Huddle started
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Huddle'
        '409':
          description: Huddle already active in channel
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /workspaces/{workspaceId}/huddles/{huddleId}:
    get:
      tags:
        - Huddles
      summary: Get huddle
      description: Get huddle details by ID
      operationId: getHuddle
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: huddleId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Huddle details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Huddle'
        '404':
          description: Huddle not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    patch:
      tags:
        - Huddles
      summary: Update huddle
      description: Update huddle topic
      operationId: updateHuddle
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: huddleId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateHuddleRequest'
      responses:
        '200':
          description: Huddle updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Huddle'
  /workspaces/{workspaceId}/huddles/{huddleId}/join:
    post:
      tags:
        - Huddles
      summary: Join huddle
      description: Join an active huddle
      operationId: joinHuddle
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: huddleId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/JoinHuddleRequest'
      responses:
        '200':
          description: Joined huddle
          content:
            application/json:
              schema:
                type: object
                properties:
                  huddle:
                    $ref: '#/components/schemas/Huddle'
                  connectionInfo:
                    type: object
                    properties:
                      token:
                        type: string
                      serverUrl:
                        type: string
                        format: uri
  /workspaces/{workspaceId}/huddles/{huddleId}/leave:
    post:
      tags:
        - Huddles
      summary: Leave huddle
      description: Leave the huddle
      operationId: leaveHuddle
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: huddleId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: Left huddle
  /workspaces/{workspaceId}/huddles/{huddleId}/action:
    post:
      tags:
        - Huddles
      summary: Huddle action
      description: Perform action in huddle (mute, video, screen share, invite)
      operationId: huddleAction
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: huddleId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/HuddleActionRequest'
      responses:
        '200':
          description: Action performed
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
  /workspaces/{workspaceId}/huddles/{huddleId}/end:
    post:
      tags:
        - Huddles
      summary: End huddle
      description: End the huddle for everyone (starter only)
      operationId: endHuddle
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: huddleId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Huddle ended
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Huddle'
        '403':
          description: Not authorized to end huddle
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /workspaces/{workspaceId}/huddles/{huddleId}/participants:
    get:
      tags:
        - Huddles
      summary: List huddle participants
      description: Get all participants in a huddle
      operationId: listHuddleParticipants
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: huddleId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Huddle participants
          content:
            application/json:
              schema:
                type: object
                properties:
                  participants:
                    type: array
                    items:
                      $ref: '#/components/schemas/HuddleParticipant'
  /workspaces/{workspaceId}/huddles/{huddleId}/invite:
    post:
      tags:
        - Huddles
      summary: Invite to huddle
      description: Invite a user to join the huddle
      operationId: inviteToHuddle
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: huddleId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - userId
              properties:
                userId:
                  type: string
                  format: uuid
      responses:
        '200':
          description: Invite sent
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HuddleInvite'
  /workspaces/{workspaceId}/huddles/{huddleId}/thread:
    get:
      tags:
        - Huddles
      summary: Get huddle thread
      description: Get chat messages from huddle
      operationId: getHuddleThread
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: huddleId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Huddle thread
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HuddleThread'
    post:
      tags:
        - Huddles
      summary: Send huddle message
      description: Send a chat message in the huddle
      operationId: sendHuddleMessage
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: huddleId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - content
              properties:
                content:
                  type: string
                  maxLength: 4000
      responses:
        '201':
          description: Message sent
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MessagePreview'
  /workspaces/{workspaceId}/huddles/{huddleId}/notes:
    get:
      tags:
        - Huddles
      summary: Get huddle notes
      description: Get shared notes from huddle
      operationId: getHuddleNotes
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: huddleId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Huddle notes
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HuddleNote'
    put:
      tags:
        - Huddles
      summary: Update huddle notes
      description: Update shared notes in huddle
      operationId: updateHuddleNotes
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: huddleId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - content
              properties:
                content:
                  type: string
                  maxLength: 10000
      responses:
        '200':
          description: Notes updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HuddleNote'
  /workspaces/{workspaceId}/search:
    post:
      tags:
        - Search
      summary: Search workspace
      description: Search messages, files, channels, and users in workspace
      operationId: search
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SearchRequest'
      responses:
        '200':
          description: Search results
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SearchResponse'
        '400':
          description: Invalid search query
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationError'
  /workspaces/{workspaceId}/search/quick:
    get:
      tags:
        - Search
      summary: Quick search
      description: Fast autocomplete search for UI suggestions
      operationId: quickSearch
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: q
          in: query
          required: true
          schema:
            type: string
            minLength: 1
          description: Search query
        - name: types
          in: query
          schema:
            type: array
            items:
              type: string
              enum:
                - channel
                - user
                - message
                - file
          description: Result types to include
      responses:
        '200':
          description: Quick search results
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/QuickSearchResponse'
  /workspaces/{workspaceId}/search/messages:
    post:
      tags:
        - Search
      summary: Search messages
      description: Search specifically for messages
      operationId: searchMessages
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              allOf:
                - $ref: '#/components/schemas/SearchRequest'
                - type: object
                  properties:
                    scope:
                      type: string
                      enum:
                        - messages
                      default: messages
      responses:
        '200':
          description: Message search results
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SearchResponse'
  /workspaces/{workspaceId}/search/files:
    post:
      tags:
        - Search
      summary: Search files
      description: Search specifically for files
      operationId: searchFiles
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              allOf:
                - $ref: '#/components/schemas/SearchRequest'
                - type: object
                  properties:
                    scope:
                      type: string
                      enum:
                        - files
                      default: files
      responses:
        '200':
          description: File search results
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SearchResponse'
  /workspaces/{workspaceId}/search/saved:
    get:
      tags:
        - Search
      summary: List saved searches
      description: Get user's saved searches
      operationId: listSavedSearches
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Saved searches
          content:
            application/json:
              schema:
                type: object
                properties:
                  searches:
                    type: array
                    items:
                      $ref: '#/components/schemas/SavedSearch'
    post:
      tags:
        - Search
      summary: Create saved search
      description: Save a search for quick access
      operationId: createSavedSearch
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateSavedSearchRequest'
      responses:
        '201':
          description: Search saved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SavedSearch'
  /workspaces/{workspaceId}/search/saved/{searchId}:
    get:
      tags:
        - Search
      summary: Get saved search
      description: Get a saved search by ID
      operationId: getSavedSearch
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: searchId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Saved search details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SavedSearch'
        '404':
          description: Saved search not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    delete:
      tags:
        - Search
      summary: Delete saved search
      description: Delete a saved search
      operationId: deleteSavedSearch
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: searchId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: Saved search deleted
  /workspaces/{workspaceId}/search/saved/{searchId}/run:
    post:
      tags:
        - Search
      summary: Run saved search
      description: Execute a saved search
      operationId: runSavedSearch
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: searchId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                page:
                  type: integer
                  minimum: 1
                  default: 1
                limit:
                  type: integer
                  minimum: 1
                  maximum: 100
                  default: 20
      responses:
        '200':
          description: Search results
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SearchResponse'
  /workspaces/{workspaceId}/search/history:
    get:
      tags:
        - Search
      summary: Get search history
      description: Get user's recent searches
      operationId: getSearchHistory
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 50
            default: 20
      responses:
        '200':
          description: Search history
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SearchHistory'
    delete:
      tags:
        - Search
      summary: Clear search history
      description: Clear user's search history
      operationId: clearSearchHistory
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: Search history cleared
  /workspaces/{workspaceId}/search/suggestions:
    get:
      tags:
        - Search
      summary: Get search suggestions
      description: Get search query suggestions based on input
      operationId: getSearchSuggestions
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: q
          in: query
          required: true
          schema:
            type: string
          description: Partial search query
      responses:
        '200':
          description: Search suggestions
          content:
            application/json:
              schema:
                type: object
                properties:
                  suggestions:
                    type: array
                    items:
                      type: object
                      properties:
                        text:
                          type: string
                        type:
                          type: string
                          enum:
                            - query
                            - filter
                            - modifier
  /notifications:
    get:
      tags:
        - Notifications
      summary: List notifications
      description: Get user's notifications
      operationId: listNotifications
      security:
        - bearerAuth: []
      parameters:
        - name: unread
          in: query
          schema:
            type: boolean
          description: Only show unread notifications
        - name: type
          in: query
          schema:
            type: string
            enum:
              - message
              - mention
              - reaction
              - thread_reply
              - channel_invite
              - workspace_invite
              - dm
              - call_incoming
              - call_missed
              - huddle_invite
              - file_shared
              - reminder
              - system
        - name: before
          in: query
          schema:
            type: string
            format: date-time
        - name: after
          in: query
          schema:
            type: string
            format: date-time
        - $ref: '#/components/parameters/PageParam'
        - $ref: '#/components/parameters/LimitParam'
      responses:
        '200':
          description: List of notifications
          content:
            application/json:
              schema:
                type: object
                properties:
                  notifications:
                    type: array
                    items:
                      $ref: '#/components/schemas/Notification'
                  pagination:
                    $ref: '#/components/schemas/Pagination'
                  unreadCount:
                    type: integer
  /notifications/{notificationId}:
    get:
      tags:
        - Notifications
      summary: Get notification
      description: Get a specific notification
      operationId: getNotification
      security:
        - bearerAuth: []
      parameters:
        - name: notificationId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Notification details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Notification'
        '404':
          description: Notification not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    delete:
      tags:
        - Notifications
      summary: Delete notification
      description: Delete a notification
      operationId: deleteNotification
      security:
        - bearerAuth: []
      parameters:
        - name: notificationId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: Notification deleted
  /notifications/read:
    post:
      tags:
        - Notifications
      summary: Mark notifications as read
      description: Mark one or more notifications as read
      operationId: markNotificationsRead
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MarkNotificationsReadRequest'
      responses:
        '200':
          description: Notifications marked as read
          content:
            application/json:
              schema:
                type: object
                properties:
                  markedCount:
                    type: integer
  /notifications/unread-count:
    get:
      tags:
        - Notifications
      summary: Get unread count
      description: Get count of unread notifications
      operationId: getUnreadCount
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Unread notification count
          content:
            application/json:
              schema:
                type: object
                properties:
                  count:
                    type: integer
                  byType:
                    type: object
                    additionalProperties:
                      type: integer
  /notifications/settings:
    get:
      tags:
        - Notifications
      summary: Get notification settings
      description: Get user's notification settings
      operationId: getNotificationSettings
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Notification settings
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotificationSettings'
    patch:
      tags:
        - Notifications
      summary: Update notification settings
      description: Update user's notification settings
      operationId: updateNotificationSettings
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateNotificationSettingsRequest'
      responses:
        '200':
          description: Settings updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotificationSettings'
  /notifications/push:
    post:
      tags:
        - Notifications
      summary: Register push subscription
      description: Register a web push subscription
      operationId: registerPushSubscription
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PushSubscription'
      responses:
        '201':
          description: Subscription registered
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                    format: uuid
    delete:
      tags:
        - Notifications
      summary: Unregister push subscription
      description: Remove a push subscription
      operationId: unregisterPushSubscription
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - endpoint
              properties:
                endpoint:
                  type: string
                  format: uri
      responses:
        '204':
          description: Subscription removed
  /notifications/device:
    post:
      tags:
        - Notifications
      summary: Register device token
      description: Register a mobile push notification token
      operationId: registerDeviceToken
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DeviceToken'
      responses:
        '201':
          description: Token registered
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                    format: uuid
    delete:
      tags:
        - Notifications
      summary: Unregister device token
      description: Remove a mobile push notification token
      operationId: unregisterDeviceToken
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - token
              properties:
                token:
                  type: string
      responses:
        '204':
          description: Token removed
  /notifications/dnd:
    get:
      tags:
        - Notifications
      summary: Get DND status
      description: Get current Do Not Disturb status
      operationId: getDndStatus
      security:
        - bearerAuth: []
      responses:
        '200':
          description: DND status
          content:
            application/json:
              schema:
                type: object
                properties:
                  enabled:
                    type: boolean
                  endsAt:
                    type: string
                    format: date-time
                  snoozeRemaining:
                    type: integer
                    description: Remaining snooze time in minutes
    put:
      tags:
        - Notifications
      summary: Set DND
      description: Enable Do Not Disturb mode
      operationId: setDnd
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                duration:
                  type: integer
                  description: Duration in minutes (0 for indefinite)
                until:
                  type: string
                  format: date-time
                  description: End time (alternative to duration)
      responses:
        '200':
          description: DND enabled
          content:
            application/json:
              schema:
                type: object
                properties:
                  enabled:
                    type: boolean
                  endsAt:
                    type: string
                    format: date-time
    delete:
      tags:
        - Notifications
      summary: Disable DND
      description: Turn off Do Not Disturb mode
      operationId: disableDnd
      security:
        - bearerAuth: []
      responses:
        '200':
          description: DND disabled
          content:
            application/json:
              schema:
                type: object
                properties:
                  enabled:
                    type: boolean
  /notifications/snooze:
    post:
      tags:
        - Notifications
      summary: Snooze notifications
      description: Temporarily snooze all notifications
      operationId: snoozeNotifications
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - duration
              properties:
                duration:
                  type: integer
                  description: Snooze duration in minutes
                  minimum: 1
                  maximum: 1440
      responses:
        '200':
          description: Notifications snoozed
          content:
            application/json:
              schema:
                type: object
                properties:
                  snoozeUntil:
                    type: string
                    format: date-time
  /notifications/test:
    post:
      tags:
        - Notifications
      summary: Send test notification
      description: Send a test notification to verify settings
      operationId: sendTestNotification
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                channel:
                  type: string
                  enum:
                    - push
                    - email
                    - desktop
                  default: push
      responses:
        '200':
          description: Test notification sent
          content:
            application/json:
              schema:
                type: object
                properties:
                  sent:
                    type: boolean
                  message:
                    type: string
  /presence:
    get:
      tags:
        - Presence
      summary: Get current user presence
      description: Get the current user's presence status
      operationId: getCurrentPresence
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Current presence
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Presence'
    put:
      tags:
        - Presence
      summary: Update presence
      description: Update current user's presence status
      operationId: updatePresence
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdatePresenceRequest'
      responses:
        '200':
          description: Presence updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Presence'
  /presence/users/{userId}:
    get:
      tags:
        - Presence
      summary: Get user presence
      description: Get presence status for a specific user
      operationId: getUserPresence
      security:
        - bearerAuth: []
      parameters:
        - name: userId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: User presence
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Presence'
        '404':
          description: User not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /presence/bulk:
    post:
      tags:
        - Presence
      summary: Get bulk presence
      description: Get presence for multiple users at once
      operationId: getBulkPresence
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - userIds
              properties:
                userIds:
                  type: array
                  items:
                    type: string
                    format: uuid
                  maxItems: 500
      responses:
        '200':
          description: Bulk presence data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BulkPresenceResponse'
  /presence/typing:
    post:
      tags:
        - Presence
      summary: Set typing indicator
      description: Indicate user is typing in a channel/thread
      operationId: setTyping
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SetTypingRequest'
      responses:
        '200':
          description: Typing indicator set
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
  /presence/typing/stop:
    post:
      tags:
        - Presence
      summary: Stop typing indicator
      description: Clear typing indicator
      operationId: stopTyping
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SetTypingRequest'
      responses:
        '200':
          description: Typing indicator cleared
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
  /presence/subscribe:
    post:
      tags:
        - Presence
      summary: Subscribe to presence updates
      description: Subscribe to real-time presence updates for users
      operationId: subscribePresence
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PresenceSubscription'
      responses:
        '200':
          description: Subscribed to presence
          content:
            application/json:
              schema:
                type: object
                properties:
                  subscriptionId:
                    type: string
                    format: uuid
  /presence/unsubscribe:
    post:
      tags:
        - Presence
      summary: Unsubscribe from presence updates
      description: Unsubscribe from real-time presence updates
      operationId: unsubscribePresence
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - subscriptionId
              properties:
                subscriptionId:
                  type: string
                  format: uuid
      responses:
        '204':
          description: Unsubscribed
  /presence/activity:
    get:
      tags:
        - Presence
      summary: Get detailed activity
      description: Get detailed activity status for current user
      operationId: getActivityStatus
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Activity status
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ActivityStatus'
  /presence/preferences:
    get:
      tags:
        - Presence
      summary: Get presence preferences
      description: Get user's presence visibility preferences
      operationId: getPresencePreferences
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Presence preferences
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PresencePreferences'
    patch:
      tags:
        - Presence
      summary: Update presence preferences
      description: Update user's presence visibility preferences
      operationId: updatePresencePreferences
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PresencePreferences'
      responses:
        '200':
          description: Preferences updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PresencePreferences'
  /presence/heartbeat:
    post:
      tags:
        - Presence
      summary: Send heartbeat
      description: Send activity heartbeat to maintain online status
      operationId: sendHeartbeat
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                activeChannelId:
                  type: string
                  format: uuid
                activeThreadId:
                  type: string
                  format: uuid
      responses:
        '200':
          description: Heartbeat received
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    enum:
                      - online
                      - away
                      - dnd
                  serverTime:
                    type: string
                    format: date-time
  /workspaces/{workspaceId}/channels/{channelId}/presence:
    get:
      tags:
        - Presence
      summary: Get channel presence
      description: Get online members and typing indicators for a channel
      operationId: getChannelPresence
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Channel presence
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ChannelPresence'
components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT token obtained from /auth/login
    ApiKeyAuth:
      type: apiKey
      in: header
      name: X-API-Key
      description: API key for service-to-service communication
    OAuth2:
      type: oauth2
      flows:
        authorizationCode:
          authorizationUrl: https://api.quikapp.io/oauth/authorize
          tokenUrl: https://api.quikapp.io/oauth/token
          scopes:
            read: Read access to user data
            write: Write access to user data
            admin: Administrative access
  schemas:
    LoginRequest:
      type: object
      required:
        - email
        - password
      properties:
        email:
          type: string
          format: email
          description: User email address
          example: user@example.com
        password:
          type: string
          format: password
          minLength: 8
          description: User password
          example: securePassword123
        mfaCode:
          type: string
          pattern: ^[0-9]{6}$
          description: MFA code if enabled
          example: '123456'
        rememberMe:
          type: boolean
          description: Extend session duration
          default: false
    UserStatus:
      type: object
      properties:
        emoji:
          type: string
          description: Status emoji
          example: 
        text:
          type: string
          maxLength: 100
          description: Status text
          example: Working from home
        expiresAt:
          type: string
          format: date-time
          description: When the status expires
          example: '2024-01-15T18:00:00Z'
        clearAfter:
          type: string
          enum:
            - never
            - 30min
            - 1h
            - 4h
            - today
            - this_week
          description: When to automatically clear status
          example: today
    User:
      type: object
      required:
        - id
        - email
        - name
        - createdAt
      properties:
        id:
          type: string
          format: uuid
          description: Unique user identifier
          example: 550e8400-e29b-41d4-a716-446655440000
        email:
          type: string
          format: email
          description: User email address
          example: john.doe@example.com
        name:
          type: string
          description: Display name
          example: John Doe
        username:
          type: string
          pattern: ^[a-z0-9_-]{3,30}$
          description: Unique username
          example: johndoe
        avatar:
          type: string
          format: uri
          description: Avatar image URL
          example: https://cdn.quikapp.io/avatars/user123.jpg
        title:
          type: string
          description: Job title
          example: Software Engineer
        timezone:
          type: string
          description: User timezone (IANA format)
          example: America/Los_Angeles
        locale:
          type: string
          description: Preferred locale
          example: en-US
        phone:
          type: string
          description: Phone number
          example: +1-555-123-4567
        status:
          $ref: '#/components/schemas/UserStatus'
        role:
          type: string
          enum:
            - user
            - admin
            - owner
          description: User role
          example: user
        isVerified:
          type: boolean
          description: Email verification status
          example: true
        mfaEnabled:
          type: boolean
          description: Whether MFA is enabled
          example: false
        lastSeenAt:
          type: string
          format: date-time
          description: Last activity timestamp
          example: '2024-01-15T10:30:00Z'
        createdAt:
          type: string
          format: date-time
          description: Account creation timestamp
          example: '2024-01-01T00:00:00Z'
        updatedAt:
          type: string
          format: date-time
          description: Last update timestamp
          example: '2024-01-15T10:30:00Z'
    TokenPair:
      type: object
      required:
        - accessToken
        - refreshToken
        - expiresIn
      properties:
        accessToken:
          type: string
          description: JWT access token
          example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
        refreshToken:
          type: string
          description: Refresh token for obtaining new access tokens
          example: dGhpcyBpcyBhIHJlZnJlc2ggdG9rZW4...
        expiresIn:
          type: integer
          description: Access token expiration time in seconds
          example: 3600
        tokenType:
          type: string
          description: Token type
          default: Bearer
          example: Bearer
    LoginResponse:
      type: object
      required:
        - user
        - tokens
      properties:
        user:
          $ref: '#/components/schemas/User'
        tokens:
          $ref: '#/components/schemas/TokenPair'
        requiresMfa:
          type: boolean
          description: Whether MFA verification is required
          default: false
        mfaMethods:
          type: array
          items:
            type: string
            enum:
              - totp
              - sms
              - email
          description: Available MFA methods
    ErrorDetail:
      type: object
      properties:
        field:
          type: string
          description: Field name that caused the error
          example: email
        message:
          type: string
          description: Specific error message for this field
          example: Invalid email format
        code:
          type: string
          description: Specific error code
          example: INVALID_FORMAT
        value:
          description: The invalid value (when safe to include)
          example: not-an-email
    Error:
      type: object
      required:
        - error
      properties:
        error:
          type: object
          required:
            - code
            - message
          properties:
            code:
              type: string
              description: Error code
              enum:
                - BAD_REQUEST
                - UNAUTHORIZED
                - FORBIDDEN
                - NOT_FOUND
                - CONFLICT
                - VALIDATION_ERROR
                - RATE_LIMITED
                - INTERNAL_ERROR
                - SERVICE_UNAVAILABLE
              example: BAD_REQUEST
            message:
              type: string
              description: Human-readable error message
              example: Invalid request parameters
            details:
              type: array
              description: Detailed error information
              items:
                $ref: '#/components/schemas/ErrorDetail'
            requestId:
              type: string
              description: Request ID for tracing
              example: req_abc123xyz
            documentation:
              type: string
              format: uri
              description: Link to relevant documentation
              example: https://docs.quikapp.io/errors/BAD_REQUEST
    RegisterRequest:
      type: object
      required:
        - email
        - password
        - name
      properties:
        email:
          type: string
          format: email
          example: newuser@example.com
        password:
          type: string
          format: password
          minLength: 8
          description: Must contain uppercase, lowercase, number, and special character
          example: SecurePass123!
        name:
          type: string
          minLength: 2
          maxLength: 100
          example: John Doe
        inviteCode:
          type: string
          description: Workspace invite code
          example: INV-ABC123
    ValidationError:
      allOf:
        - $ref: '#/components/schemas/Error'
        - type: object
          properties:
            error:
              type: object
              properties:
                code:
                  type: string
                  enum:
                    - VALIDATION_ERROR
                details:
                  type: array
                  items:
                    $ref: '#/components/schemas/ErrorDetail'
                  minItems: 1
    RefreshTokenRequest:
      type: object
      required:
        - refreshToken
      properties:
        refreshToken:
          type: string
          description: The refresh token
          example: dGhpcyBpcyBhIHJlZnJlc2ggdG9rZW4...
    PasswordResetRequest:
      type: object
      required:
        - email
      properties:
        email:
          type: string
          format: email
          example: user@example.com
    PasswordResetConfirm:
      type: object
      required:
        - token
        - password
      properties:
        token:
          type: string
          description: Password reset token from email
          example: reset_token_abc123
        password:
          type: string
          format: password
          minLength: 8
          example: NewSecurePass123!
    OAuthRequest:
      type: object
      required:
        - provider
        - code
      properties:
        provider:
          type: string
          enum:
            - google
            - github
            - microsoft
            - apple
          description: OAuth provider
          example: google
        code:
          type: string
          description: Authorization code from OAuth provider
          example: 4/P7q7W91...
        redirectUri:
          type: string
          format: uri
          description: Redirect URI used in authorization request
          example: https://app.quikapp.io/auth/callback
    MfaSetupResponse:
      type: object
      properties:
        secret:
          type: string
          description: TOTP secret for authenticator apps
          example: JBSWY3DPEHPK3PXP
        qrCode:
          type: string
          format: uri
          description: QR code image URL
          example: data:image/png;base64,...
        backupCodes:
          type: array
          items:
            type: string
          description: Backup codes for account recovery
          example:
            - ABC123
            - DEF456
            - GHI789
    MfaVerifyRequest:
      type: object
      required:
        - code
      properties:
        code:
          type: string
          pattern: ^[0-9]{6}$
          description: 6-digit MFA code
          example: '123456'
        trustDevice:
          type: boolean
          description: Remember this device
          default: false
    Session:
      type: object
      properties:
        id:
          type: string
          format: uuid
          example: 550e8400-e29b-41d4-a716-446655440000
        userId:
          type: string
          format: uuid
        device:
          type: string
          description: Device description
          example: Chrome on macOS
        ip:
          type: string
          description: IP address
          example: 192.168.1.1
        location:
          type: string
          description: Approximate location
          example: San Francisco, CA
        lastActive:
          type: string
          format: date-time
          example: '2024-01-15T10:30:00Z'
        current:
          type: boolean
          description: Whether this is the current session
          example: true
    UserUpdateRequest:
      type: object
      properties:
        name:
          type: string
          minLength: 2
          maxLength: 100
        username:
          type: string
          pattern: ^[a-z0-9_-]{3,30}$
        title:
          type: string
        bio:
          type: string
          maxLength: 500
        pronouns:
          type: string
        location:
          type: string
        website:
          type: string
          format: uri
        timezone:
          type: string
        locale:
          type: string
        phone:
          type: string
    UserProfile:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
          example: John Doe
        username:
          type: string
          example: johndoe
        avatar:
          type: string
          format: uri
        title:
          type: string
          example: Software Engineer
        bio:
          type: string
          maxLength: 500
          description: User biography
          example: Passionate about building great products
        pronouns:
          type: string
          example: he/him
        location:
          type: string
          example: San Francisco, CA
        website:
          type: string
          format: uri
          example: https://johndoe.dev
        socialLinks:
          type: object
          properties:
            twitter:
              type: string
              example: '@johndoe'
            github:
              type: string
              example: johndoe
            linkedin:
              type: string
              example: john-doe-12345
        status:
          $ref: '#/components/schemas/UserStatus'
        timezone:
          type: string
          example: America/Los_Angeles
        localTime:
          type: string
          description: Current local time for the user
          example: 10:30 AM
    DesktopNotificationSettings:
      type: object
      properties:
        enabled:
          type: boolean
          default: true
        sound:
          type: boolean
          default: true
        soundName:
          type: string
          description: Custom notification sound
          example: ding
        showPreview:
          type: boolean
          description: Show message preview
          default: true
        flashTaskbar:
          type: boolean
          default: true
        badgeCount:
          type: boolean
          default: true
    MobileNotificationSettings:
      type: object
      properties:
        enabled:
          type: boolean
          default: true
        sound:
          type: boolean
          default: true
        vibrate:
          type: boolean
          default: true
        showPreview:
          type: boolean
          default: true
        badge:
          type: boolean
          default: true
        grouping:
          type: string
          enum:
            - none
            - channel
            - workspace
          default: channel
    EmailNotificationSettings:
      type: object
      properties:
        enabled:
          type: boolean
          default: true
        frequency:
          type: string
          enum:
            - instant
            - hourly
            - daily
            - weekly
          default: daily
        includeContent:
          type: boolean
          description: Include message content in emails
          default: true
        types:
          type: array
          items:
            type: string
            enum:
              - mentions
              - dms
              - threads
              - digests
              - announcements
          default:
            - mentions
            - dms
    NotificationSchedule:
      type: object
      description: Do Not Disturb schedule
      properties:
        enabled:
          type: boolean
          default: false
        startTime:
          type: string
          pattern: ^([01]?[0-9]|2[0-3]):[0-5][0-9]$
          description: Start time (HH:MM)
          example: '22:00'
        endTime:
          type: string
          pattern: ^([01]?[0-9]|2[0-3]):[0-5][0-9]$
          description: End time (HH:MM)
          example: '08:00'
        days:
          type: array
          items:
            type: string
            enum:
              - monday
              - tuesday
              - wednesday
              - thursday
              - friday
              - saturday
              - sunday
          description: Days when schedule is active
        timezone:
          type: string
          description: Timezone for schedule
          example: America/Los_Angeles
        allowUrgent:
          type: boolean
          description: Allow urgent notifications during DND
          default: true
    ChannelNotificationSettings:
      type: object
      properties:
        level:
          type: string
          enum:
            - all
            - mentions
            - none
          default: all
        sound:
          type: boolean
        isMuted:
          type: boolean
          default: false
        mutedUntil:
          type: string
          format: date-time
    NotificationSettings:
      type: object
      properties:
        enabled:
          type: boolean
          description: Master notification toggle
          default: true
        desktop:
          $ref: '#/components/schemas/DesktopNotificationSettings'
        mobile:
          $ref: '#/components/schemas/MobileNotificationSettings'
        email:
          $ref: '#/components/schemas/EmailNotificationSettings'
        schedule:
          $ref: '#/components/schemas/NotificationSchedule'
        channels:
          type: object
          description: Per-channel notification overrides
          additionalProperties:
            $ref: '#/components/schemas/ChannelNotificationSettings'
    UserPreferences:
      type: object
      properties:
        theme:
          type: string
          enum:
            - light
            - dark
            - system
          description: UI theme preference
          default: system
          example: dark
        language:
          type: string
          description: Preferred language
          example: en
        notifications:
          $ref: '#/components/schemas/NotificationSettings'
        sidebar:
          type: object
          properties:
            collapsed:
              type: boolean
              default: false
            order:
              type: array
              items:
                type: string
              description: Custom sidebar item order
        keyboard:
          type: object
          properties:
            shortcuts:
              type: boolean
              description: Enable keyboard shortcuts
              default: true
            markdownShortcuts:
              type: boolean
              description: Enable markdown shortcuts
              default: true
        accessibility:
          type: object
          properties:
            reduceMotion:
              type: boolean
              default: false
            highContrast:
              type: boolean
              default: false
            screenReader:
              type: boolean
              default: false
        privacy:
          type: object
          properties:
            showOnlineStatus:
              type: boolean
              default: true
            showTypingIndicator:
              type: boolean
              default: true
            showReadReceipts:
              type: boolean
              default: true
    Pagination:
      type: object
      properties:
        cursor:
          type: string
          description: Cursor for the next page
          example: eyJpZCI6IjEyMzQ1In0=
        hasMore:
          type: boolean
          description: Whether there are more results
          example: true
        total:
          type: integer
          description: Total number of items (when available)
          example: 150
    WorkspaceSettings:
      type: object
      properties:
        defaultChannels:
          type: array
          items:
            type: string
            format: uuid
          description: Channels users auto-join
        allowGuestAccess:
          type: boolean
          description: Allow external guests
          default: false
        messageRetention:
          type: integer
          description: Message retention days (0 = forever)
          default: 0
        fileRetention:
          type: integer
          description: File retention days (0 = forever)
          default: 0
        allowedDomains:
          type: array
          items:
            type: string
          description: Allowed email domains for signup
          example:
            - acme.com
            - acme.io
        sso:
          type: object
          properties:
            enabled:
              type: boolean
              default: false
            provider:
              type: string
              enum:
                - saml
                - oidc
            required:
              type: boolean
              default: false
        security:
          type: object
          properties:
            mfaRequired:
              type: boolean
              default: false
            sessionTimeout:
              type: integer
              description: Session timeout in minutes
              default: 10080
            ipAllowlist:
              type: array
              items:
                type: string
              description: Allowed IP addresses/ranges
    WorkspaceStats:
      type: object
      properties:
        memberCount:
          type: integer
          description: Total number of members
          example: 150
        channelCount:
          type: integer
          description: Total number of channels
          example: 45
        messageCount:
          type: integer
          description: Total messages sent
          example: 125000
        fileCount:
          type: integer
          description: Total files shared
          example: 3500
        storageUsed:
          type: integer
          format: int64
          description: Storage used in bytes
          example: 5368709120
    Workspace:
      type: object
      required:
        - id
        - name
        - slug
        - createdAt
      properties:
        id:
          type: string
          format: uuid
          description: Unique workspace identifier
          example: 550e8400-e29b-41d4-a716-446655440000
        name:
          type: string
          description: Workspace display name
          example: Acme Corporation
        slug:
          type: string
          pattern: ^[a-z0-9-]{3,50}$
          description: URL-friendly workspace identifier
          example: acme-corp
        description:
          type: string
          maxLength: 500
          description: Workspace description
          example: Official workspace for Acme Corporation
        icon:
          type: string
          format: uri
          description: Workspace icon URL
          example: https://cdn.quikapp.io/workspaces/acme/icon.png
        domain:
          type: string
          description: Custom domain for the workspace
          example: acme.quikapp.io
        plan:
          type: string
          enum:
            - free
            - pro
            - business
            - enterprise
          description: Subscription plan
          example: business
        settings:
          $ref: '#/components/schemas/WorkspaceSettings'
        stats:
          $ref: '#/components/schemas/WorkspaceStats'
        ownerId:
          type: string
          format: uuid
          description: Workspace owner user ID
        createdAt:
          type: string
          format: date-time
          example: '2024-01-01T00:00:00Z'
        updatedAt:
          type: string
          format: date-time
          example: '2024-01-15T10:30:00Z'
    WorkspaceCreateRequest:
      type: object
      required:
        - name
      properties:
        name:
          type: string
          minLength: 2
          maxLength: 100
          example: My Workspace
        slug:
          type: string
          pattern: ^[a-z0-9-]{3,50}$
          description: Auto-generated if not provided
        description:
          type: string
          maxLength: 500
    WorkspaceUpdateRequest:
      type: object
      properties:
        name:
          type: string
          minLength: 2
          maxLength: 100
        description:
          type: string
          maxLength: 500
        settings:
          $ref: '#/components/schemas/WorkspaceSettings'
    WorkspaceMember:
      type: object
      required:
        - userId
        - workspaceId
        - role
        - joinedAt
      properties:
        userId:
          type: string
          format: uuid
        workspaceId:
          type: string
          format: uuid
        user:
          $ref: '#/components/schemas/UserProfile'
        role:
          type: string
          enum:
            - member
            - admin
            - owner
            - guest
          description: Member role in workspace
          example: member
        title:
          type: string
          description: Custom title in workspace
          example: Engineering Lead
        isActive:
          type: boolean
          description: Whether the member is active
          default: true
        joinedAt:
          type: string
          format: date-time
          example: '2024-01-01T00:00:00Z'
        invitedBy:
          type: string
          format: uuid
          description: User who invited this member
    WorkspaceInvite:
      type: object
      required:
        - id
        - workspaceId
        - email
        - status
      properties:
        id:
          type: string
          format: uuid
        workspaceId:
          type: string
          format: uuid
        email:
          type: string
          format: email
          example: newuser@example.com
        role:
          type: string
          enum:
            - member
            - admin
            - guest
          default: member
        channels:
          type: array
          items:
            type: string
            format: uuid
          description: Channels to auto-add user to
        message:
          type: string
          description: Custom invite message
        status:
          type: string
          enum:
            - pending
            - accepted
            - expired
            - revoked
          example: pending
        expiresAt:
          type: string
          format: date-time
        invitedBy:
          type: string
          format: uuid
        createdAt:
          type: string
          format: date-time
    InviteMembersRequest:
      type: object
      required:
        - emails
      properties:
        emails:
          type: array
          items:
            type: string
            format: email
          minItems: 1
          maxItems: 100
          description: Email addresses to invite
        role:
          type: string
          enum:
            - member
            - admin
            - guest
          default: member
        channels:
          type: array
          items:
            type: string
            format: uuid
          description: Channels to auto-add invitees to
        message:
          type: string
          maxLength: 500
          description: Custom invite message
    MessagePreview:
      type: object
      description: Condensed message for lists and previews
      properties:
        id:
          type: string
          format: uuid
        userId:
          type: string
          format: uuid
        user:
          $ref: '#/components/schemas/UserProfile'
        content:
          type: string
          maxLength: 200
          description: Truncated content
        type:
          type: string
          enum:
            - text
            - system
            - bot
        hasAttachments:
          type: boolean
        createdAt:
          type: string
          format: date-time
    ChannelSettings:
      type: object
      properties:
        postingPermissions:
          type: string
          enum:
            - everyone
            - admins
            - specific_members
          description: Who can post in this channel
          default: everyone
        threadRepliesOnly:
          type: boolean
          description: Only allow replies in threads
          default: false
        slowMode:
          type: integer
          description: Seconds between posts per user (0 = disabled)
          default: 0
          minimum: 0
          maximum: 3600
        retentionDays:
          type: integer
          description: Message retention days (0 = workspace default)
          default: 0
    Channel:
      type: object
      required:
        - id
        - workspaceId
        - name
        - type
        - createdAt
      properties:
        id:
          type: string
          format: uuid
          description: Unique channel identifier
          example: 550e8400-e29b-41d4-a716-446655440000
        workspaceId:
          type: string
          format: uuid
          description: Parent workspace ID
        name:
          type: string
          pattern: ^[a-z0-9-_]{1,80}$
          description: Channel name
          example: general
        displayName:
          type: string
          maxLength: 100
          description: Human-readable display name
          example: General Discussion
        type:
          type: string
          enum:
            - public
            - private
            - dm
            - group_dm
          description: Channel type
          example: public
        description:
          type: string
          maxLength: 500
          description: Channel description
          example: General discussion for the team
        topic:
          type: string
          maxLength: 250
          description: Current channel topic
          example: Q1 Planning
        icon:
          type: string
          description: Channel icon emoji
          example: 
        isArchived:
          type: boolean
          description: Whether the channel is archived
          default: false
        isDefault:
          type: boolean
          description: Whether this is a default channel for new members
          default: false
        memberCount:
          type: integer
          description: Number of members in the channel
          example: 25
        unreadCount:
          type: integer
          description: Unread message count for current user
          example: 5
        lastMessageAt:
          type: string
          format: date-time
          description: Timestamp of last message
        lastMessage:
          $ref: '#/components/schemas/MessagePreview'
        settings:
          $ref: '#/components/schemas/ChannelSettings'
        createdBy:
          type: string
          format: uuid
          description: User who created the channel
        createdAt:
          type: string
          format: date-time
          example: '2024-01-01T00:00:00Z'
        updatedAt:
          type: string
          format: date-time
    ChannelCreateRequest:
      type: object
      required:
        - name
      properties:
        name:
          type: string
          pattern: ^[a-z0-9-_]{1,80}$
          example: project-alpha
        displayName:
          type: string
          maxLength: 100
        type:
          type: string
          enum:
            - public
            - private
          default: public
        description:
          type: string
          maxLength: 500
        topic:
          type: string
          maxLength: 250
        icon:
          type: string
        isDefault:
          type: boolean
          default: false
        members:
          type: array
          items:
            type: string
            format: uuid
          description: Initial members to add
    ChannelUpdateRequest:
      type: object
      properties:
        name:
          type: string
          pattern: ^[a-z0-9-_]{1,80}$
        displayName:
          type: string
          maxLength: 100
        description:
          type: string
          maxLength: 500
        topic:
          type: string
          maxLength: 250
        icon:
          type: string
        isArchived:
          type: boolean
        settings:
          $ref: '#/components/schemas/ChannelSettings'
    ChannelMember:
      type: object
      required:
        - userId
        - channelId
        - role
        - joinedAt
      properties:
        userId:
          type: string
          format: uuid
        channelId:
          type: string
          format: uuid
        user:
          $ref: '#/components/schemas/UserProfile'
        role:
          type: string
          enum:
            - member
            - admin
            - owner
          description: Member role in channel
          example: member
        notifications:
          type: string
          enum:
            - all
            - mentions
            - none
          description: Notification preference
          default: all
        isMuted:
          type: boolean
          description: Whether notifications are muted
          default: false
        mutedUntil:
          type: string
          format: date-time
          description: Mute expiration time
        lastReadAt:
          type: string
          format: date-time
          description: Last read message timestamp
        lastReadMessageId:
          type: string
          format: uuid
          description: Last read message ID
        joinedAt:
          type: string
          format: date-time
    AddMembersRequest:
      type: object
      required:
        - userIds
      properties:
        userIds:
          type: array
          items:
            type: string
            format: uuid
          minItems: 1
          maxItems: 100
    DirectMessage:
      type: object
      description: Direct message channel between two users
      properties:
        id:
          type: string
          format: uuid
        type:
          type: string
          enum:
            - dm
        participants:
          type: array
          items:
            $ref: '#/components/schemas/UserProfile'
          minItems: 2
          maxItems: 2
        lastMessage:
          $ref: '#/components/schemas/MessagePreview'
        unreadCount:
          type: integer
    GroupDirectMessage:
      type: object
      description: Group direct message channel
      properties:
        id:
          type: string
          format: uuid
        type:
          type: string
          enum:
            - group_dm
        name:
          type: string
          description: Optional group name
        participants:
          type: array
          items:
            $ref: '#/components/schemas/UserProfile'
          minItems: 3
          maxItems: 9
        lastMessage:
          $ref: '#/components/schemas/MessagePreview'
        unreadCount:
          type: integer
    TextObject:
      type: object
      required:
        - type
        - text
      properties:
        type:
          type: string
          enum:
            - plain_text
            - mrkdwn
        text:
          type: string
          maxLength: 3000
        emoji:
          type: boolean
          default: true
        verbatim:
          type: boolean
          default: false
    SelectOption:
      type: object
      required:
        - text
        - value
      properties:
        text:
          $ref: '#/components/schemas/TextObject'
        value:
          type: string
          maxLength: 150
        description:
          $ref: '#/components/schemas/TextObject'
    BlockElement:
      type: object
      required:
        - type
      properties:
        type:
          type: string
          enum:
            - button
            - image
            - static_select
            - multi_static_select
            - users_select
            - channels_select
            - overflow
            - datepicker
            - timepicker
            - checkbox
            - radio_buttons
            - plain_text_input
        text:
          $ref: '#/components/schemas/TextObject'
        actionId:
          type: string
        value:
          type: string
        url:
          type: string
          format: uri
        style:
          type: string
          enum:
            - primary
            - danger
        options:
          type: array
          items:
            $ref: '#/components/schemas/SelectOption'
        placeholder:
          $ref: '#/components/schemas/TextObject'
    MessageBlock:
      type: object
      required:
        - type
      properties:
        type:
          type: string
          enum:
            - section
            - divider
            - image
            - context
            - actions
            - header
            - input
            - file
            - video
            - code
            - quote
            - callout
            - table
          description: Block type
        text:
          $ref: '#/components/schemas/TextObject'
        accessory:
          $ref: '#/components/schemas/BlockElement'
        elements:
          type: array
          items:
            $ref: '#/components/schemas/BlockElement'
        fields:
          type: array
          items:
            $ref: '#/components/schemas/TextObject'
          maxItems: 10
        imageUrl:
          type: string
          format: uri
        altText:
          type: string
        title:
          $ref: '#/components/schemas/TextObject'
        blockId:
          type: string
          description: Unique block identifier
    FileAttachment:
      type: object
      description: File attached to a message
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        mimeType:
          type: string
        size:
          type: integer
          format: int64
        url:
          type: string
          format: uri
        thumbnailUrl:
          type: string
          format: uri
        category:
          type: string
          enum:
            - image
            - video
            - audio
            - document
            - spreadsheet
            - presentation
            - archive
            - code
            - other
    Mention:
      type: object
      required:
        - type
        - id
      properties:
        type:
          type: string
          enum:
            - user
            - channel
            - usergroup
            - everyone
            - here
          description: Mention type
        id:
          type: string
          description: ID of mentioned entity
        name:
          type: string
          description: Display name
        offset:
          type: integer
          description: Character offset in content
        length:
          type: integer
          description: Length of mention text
    Reaction:
      type: object
      required:
        - emoji
        - count
      properties:
        emoji:
          type: string
          description: Reaction emoji
          example: 
        name:
          type: string
          description: Emoji name without colons
          example: thumbsup
        count:
          type: integer
          description: Number of reactions
          example: 5
        users:
          type: array
          items:
            type: string
            format: uuid
          description: User IDs who reacted
        me:
          type: boolean
          description: Whether current user reacted
          default: false
    Message:
      type: object
      required:
        - id
        - channelId
        - userId
        - content
        - type
        - createdAt
      properties:
        id:
          type: string
          format: uuid
          description: Unique message identifier
          example: 550e8400-e29b-41d4-a716-446655440000
        channelId:
          type: string
          format: uuid
          description: Channel where message was posted
        threadId:
          type: string
          format: uuid
          description: Parent thread ID if this is a reply
        userId:
          type: string
          format: uuid
          description: Author user ID
        user:
          $ref: '#/components/schemas/UserProfile'
        content:
          type: string
          maxLength: 40000
          description: Message content (markdown supported)
          example: Hello team! Check out this **important** update.
        type:
          type: string
          enum:
            - text
            - system
            - bot
            - ephemeral
          description: Message type
          example: text
        blocks:
          type: array
          items:
            $ref: '#/components/schemas/MessageBlock'
          description: Rich content blocks
        attachments:
          type: array
          items:
            $ref: '#/components/schemas/FileAttachment'
          description: File attachments
        mentions:
          type: array
          items:
            $ref: '#/components/schemas/Mention'
          description: User and channel mentions
        reactions:
          type: array
          items:
            $ref: '#/components/schemas/Reaction'
          description: Message reactions
        replyCount:
          type: integer
          description: Number of thread replies
          example: 5
        replyUsers:
          type: array
          items:
            $ref: '#/components/schemas/UserProfile'
          maxItems: 5
          description: Users who replied (preview)
        lastReplyAt:
          type: string
          format: date-time
          description: Timestamp of last reply
        isEdited:
          type: boolean
          description: Whether message was edited
          default: false
        editedAt:
          type: string
          format: date-time
          description: Last edit timestamp
        isPinned:
          type: boolean
          description: Whether message is pinned
          default: false
        pinnedBy:
          type: string
          format: uuid
          description: User who pinned the message
        pinnedAt:
          type: string
          format: date-time
          description: When message was pinned
        isBookmarked:
          type: boolean
          description: Whether current user bookmarked this
          default: false
        metadata:
          type: object
          additionalProperties: true
          description: Additional message metadata
        createdAt:
          type: string
          format: date-time
          example: '2024-01-15T10:30:00Z'
        updatedAt:
          type: string
          format: date-time
    MessageCreateRequest:
      type: object
      required:
        - content
      properties:
        content:
          type: string
          maxLength: 40000
          description: Message content
        blocks:
          type: array
          items:
            $ref: '#/components/schemas/MessageBlock'
        attachments:
          type: array
          items:
            type: string
            format: uuid
          description: File IDs to attach
        threadId:
          type: string
          format: uuid
          description: Thread ID for replies
        replyBroadcast:
          type: boolean
          description: Also post reply to channel
          default: false
        unfurlLinks:
          type: boolean
          description: Enable link previews
          default: true
        unfurlMedia:
          type: boolean
          description: Enable media previews
          default: true
        metadata:
          type: object
          additionalProperties: true
    MessageUpdateRequest:
      type: object
      properties:
        content:
          type: string
          maxLength: 40000
        blocks:
          type: array
          items:
            $ref: '#/components/schemas/MessageBlock'
        attachments:
          type: array
          items:
            type: string
            format: uuid
    ReactionRequest:
      type: object
      required:
        - emoji
      properties:
        emoji:
          type: string
          description: Emoji to react with
          example: 
    ScheduledMessage:
      type: object
      required:
        - id
        - channelId
        - content
        - scheduledFor
      properties:
        id:
          type: string
          format: uuid
        channelId:
          type: string
          format: uuid
        content:
          type: string
        blocks:
          type: array
          items:
            $ref: '#/components/schemas/MessageBlock'
        scheduledFor:
          type: string
          format: date-time
          description: When to send the message
        createdAt:
          type: string
          format: date-time
    ScheduleMessageRequest:
      type: object
      required:
        - content
        - scheduledFor
      properties:
        content:
          type: string
          maxLength: 40000
        blocks:
          type: array
          items:
            $ref: '#/components/schemas/MessageBlock'
        attachments:
          type: array
          items:
            type: string
            format: uuid
        scheduledFor:
          type: string
          format: date-time
          description: ISO 8601 timestamp
    ThreadSummary:
      type: object
      description: Condensed thread for listings
      properties:
        id:
          type: string
          format: uuid
        channelId:
          type: string
          format: uuid
        channelName:
          type: string
        parentMessagePreview:
          type: string
          maxLength: 100
        replyCount:
          type: integer
        participantCount:
          type: integer
        lastReplyAt:
          type: string
          format: date-time
        unreadCount:
          type: integer
        isSubscribed:
          type: boolean
    ThreadListResponse:
      type: object
      required:
        - threads
        - pagination
      properties:
        threads:
          type: array
          items:
            $ref: '#/components/schemas/ThreadSummary'
        pagination:
          $ref: '#/components/schemas/Pagination'
    Thread:
      type: object
      required:
        - id
        - channelId
        - parentMessage
        - replyCount
        - createdAt
      properties:
        id:
          type: string
          format: uuid
          description: Thread identifier (same as parent message ID)
          example: 550e8400-e29b-41d4-a716-446655440000
        channelId:
          type: string
          format: uuid
          description: Channel containing the thread
        parentMessage:
          $ref: '#/components/schemas/Message'
        replyCount:
          type: integer
          description: Total number of replies
          example: 15
        participantCount:
          type: integer
          description: Number of unique participants
          example: 5
        participants:
          type: array
          items:
            $ref: '#/components/schemas/UserProfile'
          maxItems: 10
          description: Thread participants (preview)
        lastReply:
          $ref: '#/components/schemas/MessagePreview'
        lastReplyAt:
          type: string
          format: date-time
          description: Timestamp of last reply
        isSubscribed:
          type: boolean
          description: Whether current user is subscribed
          default: false
        unreadCount:
          type: integer
          description: Unread replies for current user
          example: 3
        isResolved:
          type: boolean
          description: Whether thread is marked resolved
          default: false
        resolvedBy:
          type: string
          format: uuid
          description: User who resolved the thread
        resolvedAt:
          type: string
          format: date-time
        createdAt:
          type: string
          format: date-time
          example: '2024-01-15T10:30:00Z'
        updatedAt:
          type: string
          format: date-time
    UpdateThreadRequest:
      type: object
      properties:
        isResolved:
          type: boolean
          description: Mark thread as resolved/unresolved
    ThreadReply:
      allOf:
        - $ref: '#/components/schemas/Message'
        - type: object
          properties:
            threadId:
              type: string
              format: uuid
              description: Parent thread ID
            replyBroadcast:
              type: boolean
              description: Whether reply was broadcast to channel
              default: false
    ThreadRepliesResponse:
      type: object
      required:
        - replies
        - pagination
      properties:
        parentMessage:
          $ref: '#/components/schemas/Message'
        replies:
          type: array
          items:
            $ref: '#/components/schemas/ThreadReply'
        pagination:
          $ref: '#/components/schemas/Pagination'
        hasMore:
          type: boolean
    SubscribeThreadRequest:
      type: object
      properties:
        subscribed:
          type: boolean
          description: Subscribe or unsubscribe
          default: true
        notifyOn:
          type: string
          enum:
            - all
            - mentions
            - none
          default: all
    ThreadSubscription:
      type: object
      required:
        - threadId
        - userId
        - subscribed
      properties:
        threadId:
          type: string
          format: uuid
        userId:
          type: string
          format: uuid
        subscribed:
          type: boolean
          description: Whether user is subscribed
        notifyOn:
          type: string
          enum:
            - all
            - mentions
            - none
          description: When to notify user
          default: all
        lastReadAt:
          type: string
          format: date-time
        lastReadMessageId:
          type: string
          format: uuid
    FileMetadata:
      type: object
      description: Additional file metadata based on type
      properties:
        width:
          type: integer
          description: Image/video width
        height:
          type: integer
          description: Image/video height
        duration:
          type: number
          description: Audio/video duration in seconds
        pages:
          type: integer
          description: Document page count
        hasAudio:
          type: boolean
          description: Whether video has audio
        codec:
          type: string
          description: Audio/video codec
        bitrate:
          type: integer
          description: Audio/video bitrate
        artist:
          type: string
          description: Audio artist
        album:
          type: string
          description: Audio album
        exif:
          type: object
          additionalProperties: true
          description: EXIF data for images
    FileShare:
      type: object
      required:
        - id
        - type
        - targetId
      properties:
        id:
          type: string
          format: uuid
        type:
          type: string
          enum:
            - user
            - channel
            - workspace
            - public
          description: Share type
        targetId:
          type: string
          format: uuid
          description: ID of user/channel/workspace
        permissions:
          type: string
          enum:
            - view
            - download
            - edit
          default: view
        sharedBy:
          type: string
          format: uuid
        sharedAt:
          type: string
          format: date-time
        expiresAt:
          type: string
          format: date-time
    File:
      type: object
      required:
        - id
        - name
        - mimeType
        - size
        - uploadedBy
        - createdAt
      properties:
        id:
          type: string
          format: uuid
          description: Unique file identifier
          example: 550e8400-e29b-41d4-a716-446655440000
        name:
          type: string
          maxLength: 255
          description: Original filename
          example: quarterly-report.pdf
        displayName:
          type: string
          maxLength: 255
          description: Custom display name
        mimeType:
          type: string
          description: MIME type
          example: application/pdf
        size:
          type: integer
          format: int64
          description: File size in bytes
          example: 1048576
        extension:
          type: string
          description: File extension
          example: pdf
        url:
          type: string
          format: uri
          description: Download URL
        thumbnailUrl:
          type: string
          format: uri
          description: Thumbnail URL for images/videos
        previewUrl:
          type: string
          format: uri
          description: Preview URL
        uploadedBy:
          type: string
          format: uuid
          description: User who uploaded the file
        uploader:
          $ref: '#/components/schemas/UserProfile'
        workspaceId:
          type: string
          format: uuid
        channelId:
          type: string
          format: uuid
          description: Channel where file was shared
        messageId:
          type: string
          format: uuid
          description: Message containing the file
        category:
          type: string
          enum:
            - image
            - video
            - audio
            - document
            - spreadsheet
            - presentation
            - archive
            - code
            - other
          description: File category
        metadata:
          $ref: '#/components/schemas/FileMetadata'
        isPublic:
          type: boolean
          description: Whether file is publicly accessible
          default: false
        expiresAt:
          type: string
          format: date-time
          description: When file access expires
        downloadCount:
          type: integer
          description: Number of downloads
        shares:
          type: array
          items:
            $ref: '#/components/schemas/FileShare'
        createdAt:
          type: string
          format: date-time
          example: '2024-01-15T10:30:00Z'
        updatedAt:
          type: string
          format: date-time
    FileUploadRequest:
      type: object
      required:
        - name
        - mimeType
        - size
      properties:
        name:
          type: string
          maxLength: 255
        mimeType:
          type: string
        size:
          type: integer
          format: int64
          description: File size in bytes
        channelId:
          type: string
          format: uuid
        messageId:
          type: string
          format: uuid
        isPublic:
          type: boolean
          default: false
    FileUploadResponse:
      type: object
      required:
        - fileId
        - uploadUrl
        - expiresAt
      properties:
        fileId:
          type: string
          format: uuid
          description: Reserved file ID
        uploadUrl:
          type: string
          format: uri
          description: Pre-signed upload URL
        uploadMethod:
          type: string
          enum:
            - PUT
            - POST
          default: PUT
        headers:
          type: object
          additionalProperties:
            type: string
          description: Required headers for upload
        expiresAt:
          type: string
          format: date-time
          description: When upload URL expires
    FileUpdateRequest:
      type: object
      properties:
        displayName:
          type: string
          maxLength: 255
        isPublic:
          type: boolean
    ShareFileRequest:
      type: object
      required:
        - type
        - targetId
      properties:
        type:
          type: string
          enum:
            - user
            - channel
            - workspace
            - public
        targetId:
          type: string
          format: uuid
        permissions:
          type: string
          enum:
            - view
            - download
            - edit
          default: view
        expiresAt:
          type: string
          format: date-time
        notifyTarget:
          type: boolean
          default: true
    StorageQuota:
      type: object
      properties:
        used:
          type: integer
          format: int64
          description: Storage used in bytes
        limit:
          type: integer
          format: int64
          description: Storage limit in bytes
        percentage:
          type: number
          format: float
          description: Usage percentage
        fileCount:
          type: integer
          description: Total file count
    ExternalLink:
      type: object
      description: External link shared in messages
      properties:
        url:
          type: string
          format: uri
        title:
          type: string
        description:
          type: string
        siteName:
          type: string
        imageUrl:
          type: string
          format: uri
        faviconUrl:
          type: string
          format: uri
        contentType:
          type: string
          enum:
            - article
            - video
            - image
            - audio
            - rich
            - website
        author:
          type: string
        publishedAt:
          type: string
          format: date-time
    CallParticipant:
      type: object
      required:
        - userId
        - status
        - joinedAt
      properties:
        userId:
          type: string
          format: uuid
        user:
          $ref: '#/components/schemas/UserProfile'
        status:
          type: string
          enum:
            - invited
            - joining
            - connected
            - disconnected
            - left
          description: Participant status
        role:
          type: string
          enum:
            - host
            - co-host
            - participant
          description: Participant role in call
          default: participant
        isAudioMuted:
          type: boolean
          description: Audio mute status
          default: false
        isVideoMuted:
          type: boolean
          description: Video mute status
          default: false
        isScreenSharing:
          type: boolean
          description: Screen sharing status
          default: false
        isHandRaised:
          type: boolean
          description: Hand raised status
          default: false
        isSpeaking:
          type: boolean
          description: Currently speaking
          default: false
        joinedAt:
          type: string
          format: date-time
        leftAt:
          type: string
          format: date-time
        duration:
          type: integer
          description: Time in call (seconds)
    CallSettings:
      type: object
      properties:
        allowScreenShare:
          type: boolean
          description: Allow screen sharing
          default: true
        allowRecording:
          type: boolean
          description: Allow call recording
          default: false
        muteOnJoin:
          type: boolean
          description: Mute participants on join
          default: false
        videoOnJoin:
          type: boolean
          description: Enable video on join
          default: true
        waitingRoom:
          type: boolean
          description: Enable waiting room
          default: false
        requirePassword:
          type: boolean
          description: Require password to join
          default: false
        password:
          type: string
          description: Call password (if required)
        allowChat:
          type: boolean
          description: Allow in-call chat
          default: true
        allowReactions:
          type: boolean
          description: Allow emoji reactions
          default: true
        blur:
          type: boolean
          description: Enable background blur
          default: false
        noiseSuppression:
          type: boolean
          description: Enable noise suppression
          default: true
    CallRecording:
      type: object
      properties:
        id:
          type: string
          format: uuid
        status:
          type: string
          enum:
            - recording
            - processing
            - ready
            - failed
        startedAt:
          type: string
          format: date-time
        endedAt:
          type: string
          format: date-time
        duration:
          type: integer
          description: Recording duration in seconds
        fileSize:
          type: integer
          format: int64
          description: File size in bytes
        url:
          type: string
          format: uri
          description: Download URL (when ready)
        transcriptUrl:
          type: string
          format: uri
          description: Transcript download URL
        expiresAt:
          type: string
          format: date-time
          description: When recording expires
    Call:
      type: object
      required:
        - id
        - type
        - status
        - initiatedBy
        - createdAt
      properties:
        id:
          type: string
          format: uuid
          description: Unique call identifier
          example: 550e8400-e29b-41d4-a716-446655440000
        type:
          type: string
          enum:
            - audio
            - video
          description: Call type
          example: video
        status:
          type: string
          enum:
            - ringing
            - active
            - ended
            - missed
            - declined
          description: Current call status
          example: active
        channelId:
          type: string
          format: uuid
          description: Channel where call was initiated
        workspaceId:
          type: string
          format: uuid
          description: Workspace ID
        title:
          type: string
          maxLength: 200
          description: Call title/topic
          example: Sprint Planning Meeting
        initiatedBy:
          type: string
          format: uuid
          description: User who started the call
        initiator:
          $ref: '#/components/schemas/UserProfile'
        participants:
          type: array
          items:
            $ref: '#/components/schemas/CallParticipant'
          description: Current participants
        maxParticipants:
          type: integer
          description: Maximum allowed participants
          example: 50
        settings:
          $ref: '#/components/schemas/CallSettings'
        recording:
          $ref: '#/components/schemas/CallRecording'
        startedAt:
          type: string
          format: date-time
          description: When call started
        endedAt:
          type: string
          format: date-time
          description: When call ended
        duration:
          type: integer
          description: Call duration in seconds
          example: 3600
        joinUrl:
          type: string
          format: uri
          description: URL to join the call
        createdAt:
          type: string
          format: date-time
          example: '2024-01-15T10:30:00Z'
    CallCreateRequest:
      type: object
      required:
        - type
      properties:
        type:
          type: string
          enum:
            - audio
            - video
        channelId:
          type: string
          format: uuid
          description: Channel to start call in
        title:
          type: string
          maxLength: 200
        participants:
          type: array
          items:
            type: string
            format: uuid
          description: User IDs to invite
        settings:
          $ref: '#/components/schemas/CallSettings'
        scheduledFor:
          type: string
          format: date-time
          description: Schedule call for later
    CallRecurrence:
      type: object
      properties:
        frequency:
          type: string
          enum:
            - daily
            - weekly
            - biweekly
            - monthly
        daysOfWeek:
          type: array
          items:
            type: string
            enum:
              - monday
              - tuesday
              - wednesday
              - thursday
              - friday
              - saturday
              - sunday
        endDate:
          type: string
          format: date
        occurrences:
          type: integer
          description: Number of occurrences
    ScheduledCall:
      type: object
      required:
        - id
        - type
        - scheduledFor
        - createdBy
      properties:
        id:
          type: string
          format: uuid
        type:
          type: string
          enum:
            - audio
            - video
        title:
          type: string
        description:
          type: string
        scheduledFor:
          type: string
          format: date-time
        duration:
          type: integer
          description: Expected duration in minutes
        channelId:
          type: string
          format: uuid
        invitees:
          type: array
          items:
            type: string
            format: uuid
        settings:
          $ref: '#/components/schemas/CallSettings'
        recurrence:
          $ref: '#/components/schemas/CallRecurrence'
        createdBy:
          type: string
          format: uuid
        createdAt:
          type: string
          format: date-time
    CallUpdateRequest:
      type: object
      properties:
        title:
          type: string
          maxLength: 200
        settings:
          $ref: '#/components/schemas/CallSettings'
    JoinCallRequest:
      type: object
      properties:
        password:
          type: string
          description: Call password if required
        audioMuted:
          type: boolean
          default: false
        videoMuted:
          type: boolean
          default: false
    CallActionRequest:
      type: object
      required:
        - action
      properties:
        action:
          type: string
          enum:
            - mute_audio
            - unmute_audio
            - mute_video
            - unmute_video
            - start_screen_share
            - stop_screen_share
            - raise_hand
            - lower_hand
            - start_recording
            - stop_recording
            - end_call
          description: Action to perform
        targetUserId:
          type: string
          format: uuid
          description: Target user for host actions
    HuddleParticipant:
      type: object
      required:
        - userId
        - joinedAt
      properties:
        userId:
          type: string
          format: uuid
        user:
          $ref: '#/components/schemas/UserProfile'
        isAudioMuted:
          type: boolean
          default: false
        isVideoEnabled:
          type: boolean
          default: false
        isScreenSharing:
          type: boolean
          default: false
        isSpeaking:
          type: boolean
          default: false
        joinedAt:
          type: string
          format: date-time
    Huddle:
      type: object
      required:
        - id
        - channelId
        - status
        - startedBy
        - startedAt
      properties:
        id:
          type: string
          format: uuid
          description: Unique huddle identifier
          example: 550e8400-e29b-41d4-a716-446655440000
        channelId:
          type: string
          format: uuid
          description: Channel where huddle is active
        status:
          type: string
          enum:
            - active
            - ended
          description: Huddle status
          example: active
        startedBy:
          type: string
          format: uuid
          description: User who started the huddle
        starter:
          $ref: '#/components/schemas/UserProfile'
        participants:
          type: array
          items:
            $ref: '#/components/schemas/HuddleParticipant'
          description: Current participants
        participantCount:
          type: integer
          description: Number of current participants
          example: 4
        maxParticipants:
          type: integer
          description: Maximum allowed participants
          default: 50
        hasVideo:
          type: boolean
          description: Whether video is enabled
          default: false
        hasScreenShare:
          type: boolean
          description: Whether someone is screen sharing
          default: false
        topic:
          type: string
          maxLength: 200
          description: Optional huddle topic
        inviteLink:
          type: string
          format: uri
          description: Link to join huddle
        startedAt:
          type: string
          format: date-time
          example: '2024-01-15T10:30:00Z'
        endedAt:
          type: string
          format: date-time
    StartHuddleRequest:
      type: object
      properties:
        topic:
          type: string
          maxLength: 200
        enableVideo:
          type: boolean
          default: false
        inviteUsers:
          type: array
          items:
            type: string
            format: uuid
          description: User IDs to invite immediately
    UpdateHuddleRequest:
      type: object
      properties:
        topic:
          type: string
          maxLength: 200
    JoinHuddleRequest:
      type: object
      properties:
        audioMuted:
          type: boolean
          default: false
        videoEnabled:
          type: boolean
          default: false
    HuddleActionRequest:
      type: object
      required:
        - action
      properties:
        action:
          type: string
          enum:
            - mute
            - unmute
            - enable_video
            - disable_video
            - start_screen_share
            - stop_screen_share
            - invite
            - leave
            - end
          description: Action to perform
        targetUserId:
          type: string
          format: uuid
          description: User to invite (for invite action)
    HuddleInvite:
      type: object
      required:
        - huddleId
        - invitedBy
        - invitedUser
      properties:
        huddleId:
          type: string
          format: uuid
        invitedBy:
          type: string
          format: uuid
        inviter:
          $ref: '#/components/schemas/UserProfile'
        invitedUser:
          type: string
          format: uuid
        channelId:
          type: string
          format: uuid
        channelName:
          type: string
        participantCount:
          type: integer
        createdAt:
          type: string
          format: date-time
    HuddleThread:
      type: object
      description: Chat thread associated with a huddle
      properties:
        huddleId:
          type: string
          format: uuid
        messages:
          type: array
          items:
            $ref: '#/components/schemas/MessagePreview'
        messageCount:
          type: integer
    HuddleNote:
      type: object
      description: Shared notes during huddle
      properties:
        huddleId:
          type: string
          format: uuid
        content:
          type: string
          maxLength: 10000
        lastEditedBy:
          type: string
          format: uuid
        lastEditedAt:
          type: string
          format: date-time
    SearchFilters:
      type: object
      properties:
        workspaceId:
          type: string
          format: uuid
        channelIds:
          type: array
          items:
            type: string
            format: uuid
          description: Filter by specific channels
        userIds:
          type: array
          items:
            type: string
            format: uuid
          description: Filter by authors
        from:
          type: string
          format: uuid
          description: Messages from specific user
        in:
          type: string
          description: Channel name or ID
        dateFrom:
          type: string
          format: date
          description: Messages after this date
        dateTo:
          type: string
          format: date
          description: Messages before this date
        hasAttachment:
          type: boolean
          description: Only messages with attachments
        hasLink:
          type: boolean
          description: Only messages with links
        hasReaction:
          type: boolean
          description: Only messages with reactions
        isPinned:
          type: boolean
          description: Only pinned messages
        isStarred:
          type: boolean
          description: Only starred/bookmarked items
        fileTypes:
          type: array
          items:
            type: string
            enum:
              - image
              - video
              - audio
              - document
              - spreadsheet
              - presentation
              - archive
              - code
          description: Filter files by type
        mimeTypes:
          type: array
          items:
            type: string
          description: Filter by MIME types
    SearchRequest:
      type: object
      required:
        - query
      properties:
        query:
          type: string
          minLength: 1
          maxLength: 500
          description: Search query string
          example: quarterly report
        scope:
          type: string
          enum:
            - all
            - messages
            - files
            - channels
            - users
          default: all
          description: Search scope
        filters:
          $ref: '#/components/schemas/SearchFilters'
        sort:
          type: string
          enum:
            - relevance
            - date_desc
            - date_asc
          default: relevance
        highlight:
          type: boolean
          description: Include highlighted snippets
          default: true
        page:
          type: integer
          minimum: 1
          default: 1
        limit:
          type: integer
          minimum: 1
          maximum: 100
          default: 20
    SearchHighlight:
      type: object
      properties:
        field:
          type: string
          description: Field containing the match
          example: content
        snippet:
          type: string
          description: Text snippet with highlights
          example: Check out the <em>quarterly report</em> for details
        offsets:
          type: array
          items:
            type: object
            properties:
              start:
                type: integer
              end:
                type: integer
    SearchResult:
      type: object
      required:
        - type
        - id
        - score
      properties:
        type:
          type: string
          enum:
            - message
            - file
            - channel
            - user
          description: Result type
        id:
          type: string
          format: uuid
        score:
          type: number
          format: float
          description: Relevance score
        highlights:
          type: array
          items:
            $ref: '#/components/schemas/SearchHighlight'
        message:
          $ref: '#/components/schemas/Message'
        file:
          $ref: '#/components/schemas/File'
        channel:
          $ref: '#/components/schemas/Channel'
        user:
          $ref: '#/components/schemas/UserProfile'
    FacetBucket:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
        count:
          type: integer
    DateFacetBucket:
      type: object
      properties:
        date:
          type: string
          format: date
        count:
          type: integer
    SearchFacets:
      type: object
      description: Aggregated counts for filtering
      properties:
        channels:
          type: array
          items:
            $ref: '#/components/schemas/FacetBucket'
        users:
          type: array
          items:
            $ref: '#/components/schemas/FacetBucket'
        fileTypes:
          type: array
          items:
            $ref: '#/components/schemas/FacetBucket'
        dates:
          type: array
          items:
            $ref: '#/components/schemas/DateFacetBucket'
    SearchResponse:
      type: object
      required:
        - results
        - total
        - pagination
      properties:
        query:
          type: string
          description: Original query
        results:
          type: array
          items:
            $ref: '#/components/schemas/SearchResult'
        total:
          type: integer
          description: Total number of results
        pagination:
          $ref: '#/components/schemas/Pagination'
        facets:
          $ref: '#/components/schemas/SearchFacets'
        suggestions:
          type: array
          items:
            type: string
          description: Query suggestions
    QuickSearchItem:
      type: object
      properties:
        type:
          type: string
          enum:
            - channel
            - user
            - message
            - file
            - search
        id:
          type: string
        title:
          type: string
        subtitle:
          type: string
        icon:
          type: string
        avatar:
          type: string
          format: uri
    QuickSearchResponse:
      type: object
      description: Fast autocomplete search response
      properties:
        query:
          type: string
        channels:
          type: array
          items:
            $ref: '#/components/schemas/QuickSearchItem'
          maxItems: 5
        users:
          type: array
          items:
            $ref: '#/components/schemas/QuickSearchItem'
          maxItems: 5
        messages:
          type: array
          items:
            $ref: '#/components/schemas/QuickSearchItem'
          maxItems: 5
        files:
          type: array
          items:
            $ref: '#/components/schemas/QuickSearchItem'
          maxItems: 5
        recent:
          type: array
          items:
            $ref: '#/components/schemas/QuickSearchItem'
          description: Recent searches
    SavedSearch:
      type: object
      required:
        - id
        - name
        - query
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
          maxLength: 100
          example: Project updates
        query:
          type: string
        filters:
          $ref: '#/components/schemas/SearchFilters'
        notifyOnNew:
          type: boolean
          description: Get notified on new matches
          default: false
        createdAt:
          type: string
          format: date-time
        lastUsedAt:
          type: string
          format: date-time
    CreateSavedSearchRequest:
      type: object
      required:
        - name
        - query
      properties:
        name:
          type: string
          maxLength: 100
        query:
          type: string
        filters:
          $ref: '#/components/schemas/SearchFilters'
        notifyOnNew:
          type: boolean
          default: false
    SearchHistory:
      type: object
      properties:
        recentSearches:
          type: array
          items:
            type: object
            properties:
              query:
                type: string
              timestamp:
                type: string
                format: date-time
              resultCount:
                type: integer
          maxItems: 20
    NotificationData:
      type: object
      description: Context-specific notification data
      properties:
        workspaceId:
          type: string
          format: uuid
        channelId:
          type: string
          format: uuid
        channelName:
          type: string
        messageId:
          type: string
          format: uuid
        threadId:
          type: string
          format: uuid
        callId:
          type: string
          format: uuid
        huddleId:
          type: string
          format: uuid
        fileId:
          type: string
          format: uuid
        senderId:
          type: string
          format: uuid
        senderName:
          type: string
        senderAvatar:
          type: string
          format: uri
        deepLink:
          type: string
          description: Deep link to open in app
    NotificationAction:
      type: object
      required:
        - id
        - label
      properties:
        id:
          type: string
          description: Action identifier
          example: reply
        label:
          type: string
          description: Button label
          example: Reply
        action:
          type: string
          enum:
            - open
            - reply
            - mark_read
            - dismiss
            - accept
            - decline
            - join
          description: Action type
        data:
          type: object
          additionalProperties: true
    Notification:
      type: object
      required:
        - id
        - type
        - userId
        - createdAt
      properties:
        id:
          type: string
          format: uuid
          description: Unique notification identifier
          example: 550e8400-e29b-41d4-a716-446655440000
        type:
          type: string
          enum:
            - message
            - mention
            - reaction
            - thread_reply
            - channel_invite
            - workspace_invite
            - dm
            - call_incoming
            - call_missed
            - huddle_invite
            - file_shared
            - reminder
            - system
          description: Notification type
          example: mention
        userId:
          type: string
          format: uuid
          description: User receiving notification
        title:
          type: string
          description: Notification title
          example: 'New mention in #general'
        body:
          type: string
          description: Notification body text
          example: 'John mentioned you: Hey @alice, can you review this?'
        icon:
          type: string
          description: Notification icon/emoji
          example: 
        imageUrl:
          type: string
          format: uri
          description: Avatar or preview image
        data:
          $ref: '#/components/schemas/NotificationData'
        actions:
          type: array
          items:
            $ref: '#/components/schemas/NotificationAction'
          maxItems: 3
        priority:
          type: string
          enum:
            - low
            - normal
            - high
            - urgent
          default: normal
        isRead:
          type: boolean
          default: false
        readAt:
          type: string
          format: date-time
        isSilent:
          type: boolean
          description: Whether to show without sound/vibration
          default: false
        expiresAt:
          type: string
          format: date-time
          description: When notification expires
        createdAt:
          type: string
          format: date-time
          example: '2024-01-15T10:30:00Z'
    MarkNotificationsReadRequest:
      type: object
      properties:
        notificationIds:
          type: array
          items:
            type: string
            format: uuid
          description: Specific notification IDs to mark read
        all:
          type: boolean
          description: Mark all notifications as read
          default: false
        before:
          type: string
          format: date-time
          description: Mark all before this timestamp as read
    UpdateNotificationSettingsRequest:
      type: object
      properties:
        desktop:
          $ref: '#/components/schemas/DesktopNotificationSettings'
        mobile:
          $ref: '#/components/schemas/MobileNotificationSettings'
        email:
          $ref: '#/components/schemas/EmailNotificationSettings'
        schedule:
          $ref: '#/components/schemas/NotificationSchedule'
    PushSubscription:
      type: object
      required:
        - endpoint
        - keys
      properties:
        endpoint:
          type: string
          format: uri
          description: Push service endpoint
        keys:
          type: object
          required:
            - p256dh
            - auth
          properties:
            p256dh:
              type: string
              description: Public key for encryption
            auth:
              type: string
              description: Authentication secret
        expirationTime:
          type: string
          format: date-time
    DeviceToken:
      type: object
      required:
        - token
        - platform
      properties:
        token:
          type: string
          description: Device push token
        platform:
          type: string
          enum:
            - ios
            - android
            - web
        deviceId:
          type: string
          description: Unique device identifier
        deviceName:
          type: string
          description: Device name
          example: iPhone 15 Pro
    TypingIndicator:
      type: object
      properties:
        channelId:
          type: string
          format: uuid
          description: Channel where user is typing
        threadId:
          type: string
          format: uuid
          description: Thread where user is typing
        startedAt:
          type: string
          format: date-time
    Presence:
      type: object
      required:
        - userId
        - status
        - lastSeenAt
      properties:
        userId:
          type: string
          format: uuid
        status:
          type: string
          enum:
            - online
            - away
            - dnd
            - offline
          description: Current presence status
          example: online
        statusText:
          type: string
          maxLength: 100
          description: Custom status text
          example: In a meeting
        statusEmoji:
          type: string
          description: Status emoji
          example: 
        statusExpiry:
          type: string
          format: date-time
          description: When custom status expires
        isActive:
          type: boolean
          description: Whether user is actively using app
          default: false
        lastSeenAt:
          type: string
          format: date-time
          description: Last activity timestamp
        activeDevice:
          type: string
          enum:
            - desktop
            - mobile
            - web
          description: Current active device
        inCall:
          type: boolean
          description: Whether user is in a call
          default: false
        inHuddle:
          type: boolean
          description: Whether user is in a huddle
          default: false
        typing:
          $ref: '#/components/schemas/TypingIndicator'
    UpdatePresenceRequest:
      type: object
      properties:
        status:
          type: string
          enum:
            - online
            - away
            - dnd
            - offline
        statusText:
          type: string
          maxLength: 100
        statusEmoji:
          type: string
        statusExpiry:
          type: string
          format: date-time
        clearAfter:
          type: string
          enum:
            - never
            - 30min
            - 1h
            - 4h
            - today
            - this_week
    BulkPresenceResponse:
      type: object
      properties:
        presences:
          type: object
          additionalProperties:
            $ref: '#/components/schemas/Presence'
          description: Map of userId to presence
    SetTypingRequest:
      type: object
      required:
        - channelId
      properties:
        channelId:
          type: string
          format: uuid
        threadId:
          type: string
          format: uuid
    PresenceSubscription:
      type: object
      description: Presence subscription for real-time updates
      properties:
        userIds:
          type: array
          items:
            type: string
            format: uuid
          maxItems: 500
          description: User IDs to subscribe to
        channelIds:
          type: array
          items:
            type: string
            format: uuid
          description: Channel IDs for typing indicators
    DevicePresence:
      type: object
      properties:
        deviceId:
          type: string
        deviceType:
          type: string
          enum:
            - desktop
            - mobile
            - web
            - tablet
        platform:
          type: string
          enum:
            - windows
            - macos
            - linux
            - ios
            - android
            - web
        isActive:
          type: boolean
        lastActiveAt:
          type: string
          format: date-time
        appVersion:
          type: string
    ActivityStatus:
      type: object
      description: Detailed activity status
      properties:
        userId:
          type: string
          format: uuid
        activity:
          type: string
          enum:
            - active
            - idle
            - away
            - dnd
            - offline
        source:
          type: string
          enum:
            - manual
            - auto
            - schedule
            - mobile
          description: How status was set
        idleSince:
          type: string
          format: date-time
          description: When user became idle
        devices:
          type: array
          items:
            $ref: '#/components/schemas/DevicePresence'
    PresencePreferences:
      type: object
      properties:
        autoAway:
          type: boolean
          description: Automatically set away when idle
          default: true
        autoAwayTimeout:
          type: integer
          description: Minutes before auto-away
          default: 10
          minimum: 1
          maximum: 60
        showPresence:
          type: boolean
          description: Show presence to others
          default: true
        showTyping:
          type: boolean
          description: Show typing indicator to others
          default: true
        syncAcrossDevices:
          type: boolean
          description: Sync status across all devices
          default: true
    TypingUser:
      type: object
      properties:
        userId:
          type: string
          format: uuid
        user:
          $ref: '#/components/schemas/UserProfile'
        threadId:
          type: string
          format: uuid
        startedAt:
          type: string
          format: date-time
    ChannelPresence:
      type: object
      description: Presence info for a channel
      properties:
        channelId:
          type: string
          format: uuid
        onlineCount:
          type: integer
          description: Number of online members
        onlineMembers:
          type: array
          items:
            $ref: '#/components/schemas/Presence'
          maxItems: 100
        typingUsers:
          type: array
          items:
            $ref: '#/components/schemas/TypingUser'
    Timestamp:
      type: string
      format: date-time
      description: ISO 8601 timestamp
      example: '2024-01-15T10:30:00Z'
  responses:
    BadRequest:
      description: Bad request - invalid parameters
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error:
              code: BAD_REQUEST
              message: Invalid request parameters
              details:
                - field: email
                  message: Invalid email format
    Unauthorized:
      description: Unauthorized - invalid or missing authentication
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error:
              code: UNAUTHORIZED
              message: Invalid or expired token
    Forbidden:
      description: Forbidden - insufficient permissions
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error:
              code: FORBIDDEN
              message: You do not have permission to perform this action
    NotFound:
      description: Resource not found
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error:
              code: NOT_FOUND
              message: Resource not found
    Conflict:
      description: Conflict - resource already exists
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error:
              code: CONFLICT
              message: Resource already exists
    TooManyRequests:
      description: Too many requests - rate limit exceeded
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error:
              code: RATE_LIMITED
              message: Rate limit exceeded. Try again in 60 seconds
      headers:
        X-RateLimit-Limit:
          schema:
            type: integer
          description: Request limit per minute
        X-RateLimit-Remaining:
          schema:
            type: integer
          description: Remaining requests in current window
        X-RateLimit-Reset:
          schema:
            type: integer
          description: Unix timestamp when the rate limit resets
    InternalError:
      description: Internal server error
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error:
              code: INTERNAL_ERROR
              message: An unexpected error occurred
              requestId: req_abc123
  parameters:
    WorkspaceId:
      name: workspaceId
      in: path
      required: true
      description: Unique workspace identifier
      schema:
        type: string
        format: uuid
    ChannelId:
      name: channelId
      in: path
      required: true
      description: Unique channel identifier
      schema:
        type: string
        format: uuid
    MessageId:
      name: messageId
      in: path
      required: true
      description: Unique message identifier
      schema:
        type: string
        format: uuid
    UserId:
      name: userId
      in: path
      required: true
      description: Unique user identifier
      schema:
        type: string
        format: uuid
    Cursor:
      name: cursor
      in: query
      description: Pagination cursor for next page
      schema:
        type: string
    Page:
      name: page
      in: query
      description: Page number (1-indexed)
      schema:
        type: integer
        minimum: 1
        default: 1
    Limit:
      name: limit
      in: query
      description: Number of items to return (max 100)
      schema:
        type: integer
        minimum: 1
        maximum: 100
        default: 20
    SortOrder:
      name: sort
      in: query
      description: Sort order
      schema:
        type: string
        enum:
          - asc
          - desc
        default: desc
    PageParam:
      name: page
      in: query
      description: Page number for pagination
      schema:
        type: integer
        minimum: 1
        default: 1
    LimitParam:
      name: limit
      in: query
      description: Number of items per page
      schema:
        type: integer
        minimum: 1
        maximum: 100
        default: 20
  headers:
    X-Request-Id:
      description: Unique request identifier for tracing
      schema:
        type: string
        format: uuid
    X-RateLimit-Limit:
      description: Request limit per minute
      schema:
        type: integer
    X-RateLimit-Remaining:
      description: Remaining requests in current window
      schema:
        type: integer
    X-RateLimit-Reset:
      description: Unix timestamp when the rate limit resets
      schema:
        type: integer
x-tagGroups:
  - name: Core
    tags:
      - Authentication
      - MFA
      - Users
      - Bookmarks
      - Workspaces
      - Members
      - Invites
      - Channels
      - Direct Messages
  - name: Messaging
    tags:
      - Messages
      - Reactions
      - Threads
      - Search
  - name: Communication
    tags:
      - Calls
      - Huddles
      - Presence
  - name: Content
    tags:
      - Files
      - Notifications
